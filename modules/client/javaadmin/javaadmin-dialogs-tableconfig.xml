<?xml version="1.0" encoding="UTF-8" ?>
<cmd
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="http://www.censhare.com/xml/3.0.0/dialogs-schema.xsd"
    xmlns:corpus="http://www.censhare.com/xml/3.0.0/corpus"
    xmlns:new-val="http://www.censhare.com/xml/3.0.0/new-val"
    xmlns:new-fct="http://www.censhare.com/xml/3.0.0/new-fct"
    xmlns:xe="http://www.censhare.com/xml/3.0.0/xmleditor">

  <xml-info
      localize="true">
    <property-resources>
      <base url="file:module"/>
      <base url="file:../common/module"/>
      <base url="file:../../../common/global"/>
    </property-resources>
  </xml-info>

  <cmd-info
      name="client.javaadmin.dialogs-tableconfig"
      enabled="true">
  </cmd-info>

  <!-- INCLUDE: LOCKED DESCRIPTION -->
  <xe:part id="locked-description" transactional="true">
    <xe:group align="down" visible="=:exists(*/@source)">
      <xe:label style="label-title" value="${locked}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:label label="${information}" label-style="label-default" width="30em" wordwrap="true" label-align="left-top" value="${master-data-locked-info}"/>
        <xe:label label="${module}" label-style="label-default" width="30em" wordwrap="true" label-align="left-top" source="@source"/>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- INCLUDE: LOCALIZED NAMES -->
  <xe:part id="localized-name-required" transactional="true">
    <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
      <xe:variable name="locales" value="=:cs:master-data('db_locale')"/>
      <xe:foreach align="down">
        <xe:generator expression="=:$locales"/>
        <xe:edittext label-style="label-default" label="=:concat('${name} [', db_locale/@locale, ']')" width="30em" scrollpane="false" rows="1" source="=:concat('$content@name', if (db_locale/@locale='en') then '' else concat('_', db_locale/@locale))">
          <xe:validate not-empty="=:db_locale/@locale='en'"/>
        </xe:edittext>
      </xe:foreach>
      <!--xe:foreach-locale align="down" row-align="right">
        <xe:edittext label-style="label-default" label="${name} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@name">
           <xe:validate not-empty="true"/>
        </xe:edittext>
      </xe:foreach-locale-->
    </xe:group>
  </xe:part>

  <!-- INCLUDE: LOCALIZED NAMES WITH OVERWRITE -->
  <xe:part id="localized-name-required-overwrite" transactional="true">
    <xe:group align="down">
      <xe:variable name="locales" value="=:cs:master-data('db_locale')"/>
      <xe:foreach align="down">
        <xe:generator expression="=:$locales"/>
        <!-- empty source name fields -->
        <xe:edittext visible="=:not(exists($content/*/@source))" label-style="label-default" label="=:concat('${name} [', db_locale/@locale, ']')" width="30em" scrollpane="false" rows="1" source="=:concat('$content@name', if (db_locale/@locale='en') then '' else concat('_', db_locale/@locale))">
          <xe:validate not-empty="=:db_locale/@locale='en'"/>
        </xe:edittext>
        <!-- source exists - only overwrite fields for editing -->
        <xe:group align="down" visible="=:exists($content/*/@source)">
          <xe:edittext label-style="label-default" label="=:concat('${name} [', db_locale/@locale, ']')" width="30em" scrollpane="false" rows="1" source="=:concat('$content@name', if (db_locale/@locale='en') then '' else concat('_', db_locale/@locale))" readonly="=:system-property('censhare:is-admin-mode')='false'">
            <xe:validate not-empty="=:db_locale/@locale='en'"/>
          </xe:edittext>
          <xe:edittext label-style="label-default" label="${replaced-by}" label-color="gray" width="30em" scrollpane="false" rows="1" source="=:concat('$content@name', if (db_locale/@locale='en') then '' else concat('_', db_locale/@locale), '_overwrite')"/>
        </xe:group>
      </xe:foreach>
      <!--xe:foreach-locale align="down" row-align="down">
        <xe:edittext visible="=:not(exists(*/@source))" label-style="label-default" label="${name} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@name">
          <xe:validate not-empty="='%{locale}'='en'"/>
        </xe:edittext>
        <xe:group align="down" visible="=:exists(*/@source)">
          <xe:edittext label-style="label-default" label="${name} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@name%{locale_not_default}" readonly="=:system-property('censhare:is-admin-mode')='false'"/>
          <xe:edittext label-style="label-default" label="${replaced-by}" label-color="gray" width="30em" scrollpane="false" rows="1" source="@name%{locale_not_default}_overwrite"/>
        </xe:group>
      </xe:foreach-locale-->
    </xe:group>
  </xe:part>

  <!-- INCLUDE: LOCALIZED DESCRIPTIONS (ALWAYS OPTIONAL) -->
  <xe:part id="localized-description" transactional="true">
    <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
      <xe:variable name="locales" value="=:cs:master-data('db_locale')"/>
      <xe:foreach align="down">
        <xe:generator expression="=:$locales"/>
        <xe:edittext label-style="label-default" label="=:concat('${description} [', db_locale/@locale, ']')" width="30em" scrollpane="false" rows="1" source="=:concat('$content@description', if (db_locale/@locale='en') then '' else concat('_', db_locale/@locale))"/>
      </xe:foreach>
      <!--xe:foreach-locale align="down">
        <xe:edittext label-style="label-default" label="${description} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@description"/>
      </xe:foreach-locale-->
    </xe:group>
  </xe:part>

  <!-- INCLUDE: LOCALIZED DESCRIPTIONS (ALWAYS OPTIONAL) WITH OVERWRITE -->
  <xe:part id="localized-description-overwrite" transactional="true">
    <xe:group align="down">
      <xe:variable name="locales" value="=:cs:master-data('db_locale')"/>
      <xe:foreach align="down">
        <xe:generator expression="=:$locales"/>
        <!-- empty source name fields -->
        <xe:edittext visible="=:not(exists($content/*/@source))" label-style="label-default" label="=:concat('${description} [', db_locale/@locale, ']')" width="30em" scrollpane="false" rows="1" source="=:concat('$content@description', if (db_locale/@locale='en') then '' else concat('_', db_locale/@locale))"/>
        <!-- source exists - only overwrite fields for editing -->
        <xe:group align="down" visible="=:exists($content/*/@source)">
          <xe:edittext label-style="label-default" label="=:concat('${description} [', db_locale/@locale, ']')" width="30em" scrollpane="false" rows="1" source="=:concat('$content@description', if (db_locale/@locale='en') then '' else concat('_', db_locale/@locale))" readonly="=:system-property('censhare:is-admin-mode')='false'"/>
          <xe:edittext label-style="label-default" label="${replaced-by}" label-color="gray" width="30em" scrollpane="false" rows="1" source="=:concat('$content@description', if (db_locale/@locale='en') then '' else concat('_', db_locale/@locale), '_overwrite')"/>
        </xe:group>
      </xe:foreach>
      <!--xe:foreach-locale align="down" row-align="down">
        <xe:edittext visible="=:not(exists(*/@source))" label-style="label-default" label="${description} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@description"/>
        <xe:group align="down" visible="=:exists(*/@source)">
          <xe:edittext label-style="label-default" label="${description} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@description%{locale_not_default}" readonly="=:system-property('censhare:is-admin-mode')='false'"/>
          <xe:edittext label-style="label-default" label="${replaced-by}" label-color="gray" width="30em" scrollpane="false" rows="1" source="@description%{locale_not_default}_overwrite"/>
        </xe:group>
      </xe:foreach-locale-->
    </xe:group>
  </xe:part>

  <!-- INCLUDE: LOCALIZED LABEL (ALWAYS OPTIONAL) -->
  <xe:part id="localized-label" transactional="true">
    <xe:group align="down">
      <xe:variable name="locales" value="=:cs:master-data('db_locale')"/>
      <xe:foreach align="down">
        <xe:generator expression="=:$locales"/>
        <xe:edittext label-style="label-default" label="=:concat('${label} [', db_locale/@locale, ']')" width="30em" scrollpane="false" rows="1" source="=:concat('$content@label', if (db_locale/@locale='en') then '' else concat('_', db_locale/@locale))"/>
      </xe:foreach>
      <!--xe:foreach-locale align="down">
        <xe:edittext label-style="label-default" label="${label} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@label"/>
      </xe:foreach-locale-->
    </xe:group>
  </xe:part>

  <!-- INCLUDE: LOCALIZED PLACEHOLDER TEXT (ALWAYS OPTIONAL) -->
  <xe:part id="localized-placeholder_text" transactional="true">
    <xe:group align="down">
      <xe:variable name="locales" value="=:cs:master-data('db_locale')"/>
      <xe:foreach align="down">
        <xe:generator expression="=:$locales"/>
        <xe:edittext label-style="label-default" label="=:concat('${placeholder-text} [', db_locale/@locale, ']')" width="30em" scrollpane="false" rows="1" source="=:concat('$content@placeholder_text', if (db_locale/@locale='en') then '' else concat('_', db_locale/@locale))"/>
      </xe:foreach>
      <!--xe:foreach-locale align="down">
        <xe:edittext label-style="label-default" label="${placeholder-text} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@placeholder_text"/>
      </xe:foreach-locale-->
    </xe:group>
  </xe:part>

  <!-- INCLUDE: LOCALIZED TOOLTIP (ALWAYS OPTIONAL) -->
  <xe:part id="localized-tooltip" transactional="true">
    <xe:group align="down">
      <xe:variable name="locales" value="=:cs:master-data('db_locale')"/>
      <xe:foreach align="down">
        <xe:generator expression="=:$locales"/>
        <xe:edittext label-style="label-default" label="=:concat('${tooltip} [', db_locale/@locale, ']')" width="30em" scrollpane="false" rows="1" source="=:concat('$content@tooltip', if (db_locale/@locale='en') then '' else concat('_', db_locale/@locale))"/>
      </xe:foreach>
      <!--xe:foreach-locale align="down">
        <xe:edittext label-style="label-default" label="${tooltip} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@tooltip"/>
      </xe:foreach-locale-->
    </xe:group>
  </xe:part>

  <!-- INCLUDE: DOMAINS REQUIRED -->
  <xe:part id="domains-required" transactional="true">
    <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
      <xe:popupmenutree label="${domain}" label-style="label-default" source="@domain" hide-root-popup="false" defaultvalue="=$system.party@main_domain">
        <xe:treeoptions label-key="@name" value-key="@pathid">
          <xe:generator name="cachedtables" table-name="domain"/>
          <xe:sort key="@sorting" data-type="integer"/>
        </xe:treeoptions>
        <xe:validate not-empty="true"/>
      </xe:popupmenutree>
      <xe:popupmenutree label="${domain2}" label-style="label-default" source="@domain2" hide-root-popup="false" defaultvalue="=$system.party@main_domain2">
        <xe:treeoptions label-key="@name" value-key="@pathid">
          <xe:generator name="cachedtables" table-name="domain2"/>
          <xe:sort key="@sorting" data-type="integer"/>
        </xe:treeoptions>
        <xe:validate not-empty="true"/>
      </xe:popupmenutree>
    </xe:group>
  </xe:part>

  <!-- USER TABLE DIALOG -->
  <xe:part id="table-list-users" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="partys.party" double-click-action="table-double-click" weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="last-name" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@isactive" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="display-name" label="${display-name}" source="@display_name" width="40em" filterable="true"/>
          <xe:column key="first-name" label="${first-name}" source="@firstname" width="15em" filterable="true"/>
          <xe:column key="last-name" label="${last-name}" source="@name" width="30em" filterable="true"/>
          <xe:column key="id" label="${id}" source="@id" width="5em" align="right" filterable="true" type="number"/>
          <xe:column key="login-name" label="${login-name}" source="@login" width="30em" filterable="true"/>
          <xe:column key="email" label="${e-mail}" source="@email" width="30em" filterable="true"/>
          <xe:column key="default-role" label="${default-role}" width="20em" filterable="true" formula="cachelookup('role', '@role', @main_role)@name"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@main_domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@main_domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@main_domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@main_domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="region" label="${region}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@region, '\.')))) return cs:cachelookup('region', '@pathid', concat(string-join(subsequence(tokenize(*/@region, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
        <xe:row-filters>
          <!--  filter out groups -->
          <xe:filter source="@isgroup" match="0" value-type="integer"/>
          <!--  filter out system user -->
          <xe:filter source="@id" operator="&gt;" match="1" value-type="integer"/>
        </xe:row-filters>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT USER DIALOG -->
  <xe:part id="edit-record-users" transactional="true">
    <xe:inititems>
        <!--
          presets for the domain fields:
          you can only choose domains equal or lower than the users main-domains.
          the validation to suppress domains is done in a validation-listener.
        -->
        <!-- Slots are defined in the interface Slots -->
      <xe:inititem dest="@main_domain"  value="=$system.party@main_domain"  overwrite="false"/>
      <xe:inititem dest="@main_domain2" value="=$system.party@main_domain2" overwrite="false"/>
      <xe:inititem dest="@isgroup" value="0"/>
      <xe:inititem dest="@isactive" value="1"/>
      <xe:inititem dest="@auth_standard" value="1"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group align="down" style="group-indent-left-right">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@isactive">
          <xe:validate not-null="true"/>
          <xe:change dest="@count_invalid_logins" overwrite="true" value="0"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="10em" readonly="true" source="@id" />
          <xe:group align="right">
            <xe:popupmenu label-style="label-default" label="${gender}" width="30em" source="@gender">
              <xe:options>
                <xe:option value="male" label="${male}"/>
                <xe:option value="female" label="${female}"/>
              </xe:options>
            </xe:popupmenu>
            <xe:deletebutton source="@gender"/>
          </xe:group>
          <xe:editfield label-style="label-default" label="${title}" width="30em" source="@title"/>
          <xe:editfield label-style="label-default" label="${first-name}" width="30em" source="@firstname"/>
          <xe:editfield label-style="label-default" label="${last-name}" width="30em" source="@name">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:editfield label-style="label-default" label="${display-name}" width="30em" source="@display_name">
            <xe:validate not-empty="true"/>
            <xe:listen-to source="@name">
              <xe:change dest="@display_name" overwrite="false" value="=@name + ', ' + @firstname"/>
            </xe:listen-to>
            <xe:listen-to source="@display_name">
              <xe:change dest="@display_name" overwrite="false" condition="=@display_name=null" value="=@name + ', ' + @firstname"/>
            </xe:listen-to>
          </xe:editfield>
          <xe:editfield label-style="label-default" label="${login-name}" width="30em" source="@login">
            <xe:validate condition="=:not(exists(cs:cachelookup('party','@login', */@login)) and not(exists(*/@id) and  exists(cs:cachelookup('party','@login', */@login, '@id', */@id))))" message="test"/>
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:label visible="=:exists(*/@login) and exists(cs:cachelookup('party','@login', */@login)) and not(exists(*/@id) and  exists(cs:cachelookup('party','@login', */@login, '@id', */@id)))" margin-left="15em" value="${login-already-exists}" font-weight="bold" color="red">
            <xe:listen-to source="@login"/>
          </xe:label>
          <!-- C5-11743: enable this to allow an adminstrator to set an initial password.
          <xe:password visible="=:not(exists(*/@id))" label-style="label-default" label="${initial-password}" width="30em" source="@password">
            <xe:validate condition="=:exists(*/@id) or exists(*/@password)"/>
          </xe:password>
          -->
          <xe:editfield label-style="label-default" label="${e-mail}" width="30em" source="@email">
            <xe:validate not-empty="true"/>
            <xe:validate regex=".+@.+\..+"/>
          </xe:editfield>
          <xe:group align="right">
            <xe:popupmenu label-style="label-default" label="${language}" width="30em" source="@locale" sort="ascending">
              <xe:options value-key="@client_locale" label-key="@name">
                <xe:generator name="cachedtables" table-name="language_def"/>
              </xe:options>
            </xe:popupmenu>
            <xe:deletebutton source="@locale"/>
          </xe:group>
          <xe:checkbox label="${visible}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@isvisible">
            <xe:validate not-null="true"/>
          </xe:checkbox>
          <xe:group align="right">
            <xe:checkbox label="${authentication}" label-style="label-default" caption="${party-auth-standard}" checked-value="1" unchecked-value="0" source="@auth_standard">
              <xe:listen-to source="@auth_standard">
                <xe:change dest="@auth_extern" value="=if (bool(@auth_standard), 0, 1)" overwrite="true"/>
              </xe:listen-to>
            </xe:checkbox>
            <xe:checkbox caption="${party-auth-extern}" checked-value="1" unchecked-value="0" source="@auth_extern">
              <xe:listen-to source="@auth_extern">
                <xe:change dest="@auth_standard" value="=if (bool(@auth_extern), 0, 1)" overwrite="true"/>
              </xe:listen-to>
            </xe:checkbox>
            <xe:selectcase source="@auth_extern">
              <xe:case value="1">
                <xe:popupmenu source="@sync_extern" label="${party-sync-extern}" enabled="=@auth_extern">
                  <xe:options>
                    <xe:option label="${party-sync-extern-dont}"  value="0"/>
                    <xe:option label="${party-sync-extern-basic}" value="1"/>
                    <xe:option label="${party-sync-extern-all}"   value="2"/>
                  </xe:options>
                </xe:popupmenu>
              </xe:case>
            </xe:selectcase>
          </xe:group>
          <xe:checkbox label="${system-user}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="0" source="@issystem" tooltip="${system-user-help}">
            <xe:validate not-null="true"/>
          </xe:checkbox>
          <xe:group>
            <xe:editdate label="${expiry-date}" label-style="label-default" width="30em" source="@expiry_date" readonly="=@issystem='1'"/>
            <xe:deletebutton source="@expiry_date"/>
          </xe:group>
          <xe:checkbox label-style="label-default" label="${notification}" caption="${e-mail}"
              checked-value="1" unchecked-value="0" source="@email_notification" readonly="=@email=null">
            <xe:listen-to source="@email">
              <xe:change condition="=@email=null" dest="@email_notification" value="0"/>
            </xe:listen-to>
          </xe:checkbox>
          <xe:editfield label-style="label-default" label="${asset-id}" width="30em" source="@party_asset_id" data-type="INTEGER"/>
          <xe:editfield label-style="label-default" label="${oc-sso-asset-id}" width="30em" source="@oc_sso_asset_id" data-type="INTEGER"/>
          <xe:popupmenu label="${default-role}" label-style="label-default" width="30em" source="@main_role" sort="ascending">
            <xe:options label-key="@name" value-key="@role">
              <xe:generator name="cachedtables" table-name="role"/>
                <xe:filter source="@enabled" operator="=" match="1"/>
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:popupmenutree label="${default-domain}" label-style="label-default" source="@main_domain" hide-root-popup="false">
            <xe:treeoptions value-key="@pathid" label-key="@name">
              <xe:generator name="cachedtables" table-name="domain"/>
              <xe:sort key="@sorting" data-type="integer"/>
            </xe:treeoptions>
            <xe:validate not-empty="true"/>
          </xe:popupmenutree>
          <xe:popupmenutree label="${default-domain2}" label-style="label-default" source="@main_domain2" hide-root-popup="false">
            <xe:treeoptions value-key="@pathid" label-key="@name">
              <xe:generator name="cachedtables" table-name="domain2"/>
              <xe:sort key="@sorting" data-type="integer"/>
            </xe:treeoptions>
            <xe:validate not-empty="true"/>
          </xe:popupmenutree>
          <xe:group>
            <xe:popupmenutree label="${region}" label-style="label-default" source="@region" hide-root-popup="false">
              <xe:treeoptions label-key="@name" value-key="@pathid">
                <xe:generator name="cachedtables" table-name="region"/>
                <xe:sort key="@sorting" data-type="integer"/>
              </xe:treeoptions>
            </xe:popupmenutree>
            <xe:deletebutton source="@region"/>
          </xe:group>
        </xe:group>
      </xe:group>

      <!-- Roles -->
      <xe:label style="label-title" value="${roles}" weight-x="1"/>
      <xe:group align="down" style="group-indent-left-right" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:foreach source="party_role" align="down" not-empty="true" sort-new-rows="true">
          <xe:sort expression="=cachelookup('role','@role','@role')@name + '_' + @domain + '_' + @domain2"/>
          <xe:group align="down" id="party-role-group">
            <xe:group align="right">
              <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
                <xe:validate not-null="true"/>
              </xe:checkbox>
              <xe:deletebutton/>
            </xe:group>
            <xe:popupmenu label="${role}" source="@role" label-style="label-default" width="30em" sort="ascending" id="party-role-group.party-role-popup">
              <xe:options label-key="@name" value-key="@role" id="party-role-group.party-role-popup.role">
                <xe:generator name="cachedtables" table-name="role" />
              </xe:options>
              <xe:validate not-empty="true"/>
            </xe:popupmenu>
            <xe:popupmenutree label="${domain}" source="@domain" hide-root-popup="false" label-style="label-default" id="party-role-group.domain-popupmenutree">
              <xe:treeoptions value-key="@pathid" label-key="@name" id="party-role-group.domain-popupmenutree.pathid">
                <xe:generator name="cachedtables" table-name="domain"/>
                <xe:sort key="@sorting" data-type="integer"/>
              </xe:treeoptions>
              <xe:validate not-empty="true"/>
            </xe:popupmenutree>
            <xe:popupmenutree label="${domain2}" source="@domain2" hide-root-popup="false" label-style="label-default" id="party-role-group.domain2-popupmenutree">
              <xe:treeoptions value-key="@pathid" label-key="@name" id="party-role-group.domain2-popupmenutree.pathid">
                <xe:generator name="cachedtables" table-name="domain2"/>
                <xe:sort key="@sorting" data-type="integer"/>
              </xe:treeoptions>
              <xe:validate not-empty="true"/>
            </xe:popupmenutree>
            <xe:separator/>
          </xe:group>
        </xe:foreach>
      </xe:group>

      <!-- Groups -->
      <xe:label style="label-title" value="${groups}" weight-x="1"/>
      <xe:group align="down" style="group-indent-left-right" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:foreach source="parent_partyrel" align="down" row-align="right" not-empty="true">
         <xe:sort expression="=cachelookup('party','@id','@parent_id')@display_name"/>
          <xe:popupmenu label="${group}" label-style="label-default" weight-x="1" source="@parent_id" sort="ascending">
            <xe:options label-key="@display_name" value-key="@id">
              <xe:generator name="cachedtables" table-name="party" source="@isgroup" match="1"/>
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:deletebutton/>
          <xe:checkbox caption="${enabled}" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
            <xe:validate not-null="true"/>
          </xe:checkbox>
         </xe:foreach>
      </xe:group>

    </xe:group>
  </xe:part>

  <!-- USER GROUP TABLE DIALOG -->
  <xe:part id="table-list-groups" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="partys.party" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@isactive" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@id" width="5em" align="right" filterable="true" type="number"/>
          <xe:column key="display-name" label="${display-name}" source="@display_name" width="20em" filterable="true"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@main_domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@main_domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@main_domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@main_domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="region" label="${region}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@region, '\.')))) return cs:cachelookup('region', '@pathid', concat(string-join(subsequence(tokenize(*/@region, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
        <xe:row-filters>
          <xe:filter source="@isgroup" match="1" value-type="integer"/>
        </xe:row-filters>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT USER GROUP DIALOG -->
  <xe:part id="edit-record-groups" transactional="true">
    <xe:inititems>
      <xe:inititem dest="@isgroup" value="1"/>
      <xe:inititem dest="@isactive" value="1"/>
      <xe:inititem dest="@main_domain"  value="=$system.party@main_domain"  overwrite="false"/>
      <xe:inititem dest="@main_domain2" value="=$system.party@main_domain2" overwrite="false"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group align="down" style="group-indent-left-right">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@isactive">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="10em" source="@id" readonly="true">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <!-- The name field's only purpose seems to ensure that the not nullable databasefield party.name has some value?
               Hence the value of display_name is copied and the field is not displayed -->
          <xe:editfield label="${name}" label-style="label-default" width="30em" source="@name" visible="false">
            <xe:listen-to source="@display_name">
              <xe:change dest="@name" overwrite="true" value="=@display_name"/>
            </xe:listen-to>
          </xe:editfield>
          <xe:editfield label-style="label-default" label="${display-name}" width="30em" source="@display_name">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:checkbox label="${visible}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@isvisible">
            <xe:validate not-null="true"/>
          </xe:checkbox>
          <xe:popupmenutree label="${default-domain}" label-style="label-default" source="@main_domain" hide-root-popup="false">
            <xe:treeoptions label-key="@name" value-key="@pathid">
              <xe:generator name="cachedtables" table-name="domain"/>
              <xe:sort key="@sorting" data-type="integer"/>
            </xe:treeoptions>
            <xe:validate not-null="true"/>
          </xe:popupmenutree>
          <xe:popupmenutree label="${default-domain2}" label-style="label-default" source="@main_domain2" hide-root-popup="false">
            <xe:treeoptions label-key="@name" value-key="@pathid">
              <xe:generator name="cachedtables" table-name="domain2"/>
              <xe:sort key="@sorting" data-type="integer"/>
            </xe:treeoptions>
            <xe:validate not-null="true"/>
          </xe:popupmenutree>
          <xe:group>
            <xe:popupmenutree label="${region}" label-style="label-default" source="@region" hide-root-popup="false">
              <xe:treeoptions label-key="@name" value-key="@pathid">
                <xe:generator name="cachedtables" table-name="region"/>
                <xe:sort key="@sorting" data-type="integer"/>
              </xe:treeoptions>
            </xe:popupmenutree>
            <xe:deletebutton source="@region"/>
          </xe:group>
        </xe:group>
      </xe:group>
      <!-- Users -->
      <xe:label style="label-title" value="${users}" weight-x="1"/>
      <xe:group align="down" style="group-indent-left-right" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:foreach source="child_partyrel" align="down" row-align="right" not-empty="true">
          <xe:sort expression="=cachelookup('party','@id','@child_id')@display_name"/>
          <xe:popupmenu label="${user}" label-style="label-default" width="30em" source="@child_id" sort="ascending">
            <xe:options label-key="@display_name" value-key="@id">
              <xe:generator name="cachedtables" table-name="party" source="@isgroup" match="0"/>
              <xe:filter source="@isactive" operator="=" match="1"/>
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:deletebutton/>
          <xe:checkbox caption="${enabled}" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
            <xe:validate not-null="true"/>
          </xe:checkbox>
        </xe:foreach>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- WORKFLOWS TABLE DIALOG -->
  <xe:part id="table-list-workflows" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="workflows.workflow" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@id" width="10em" filterable="true" type="number"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="default-asset-type" label="${default-asset-type}" width="15em" filterable="true" formula="cachelookup('asset_typedef', '@asset_type', @assettype_def)@name"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT WORKFLOWS DIALOG -->
  <xe:part id="edit-record-workflows" transactional="true">
    <xe:inititems>
      <!--
          presets for the domain fields:
          you can only choose domains equal or lower than the users main-domains.
          the validation to suppress domains is done in a validation-listener.
      -->
      <!-- Slots are defined in the interface Slots -->
      <xe:inititem dest="@domain"  value="=$system.party@main_domain"  overwrite="false"/>
      <xe:inititem dest="@domain2" value="=$system.party@main_domain2" overwrite="false"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
       <xe:group align="down">
          <xe:group>
            <xe:editfield label="${id}" label-style="label-default" width="10em" source="@id" data-type="INTEGER" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
              <xe:validate not-empty="true" regex="^*[1-9][0-9]*$"/>
            </xe:editfield>
            <xe:label visible="=:if (*/@id &gt;= 900000 and */@id &lt;= 1000000) then true() else false()" value="${workflow-id-range-error}" color="red">
              <xe:listen-to source="@id"/>
            </xe:label>
          </xe:group>
          <xe:include key="localized-name-required-overwrite"/>
          <xe:include key="localized-description-overwrite"/>
          <xe:include key="domains-required"/>
          <xe:group align="right" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
            <xe:popupmenu label="${default-step}" label-style="label-default" width="30em" source="@def_step">
              <xe:options source="workflow_step" label-key="@name" value-key="@wf_step">
                <xe:sort key="@sorting" data-type="integer" ascending="true"/>
              </xe:options>
            </xe:popupmenu>
            <xe:deletebutton source="@def_step"/>
          </xe:group>
          <xe:group align="right"  readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
            <xe:popupmenutree label="${default-asset-type}" label-style="label-default" source="@assettype_def" hide-root-popup="false" sort="ascending">
              <xe:treeoptions label-key="@name" value-key="@asset_type">
                <xe:generator name="cachedtables" table-name="asset_typedef"/>
              </xe:treeoptions>
            </xe:popupmenutree>
            <xe:deletebutton source="@assettype_def"/>
          </xe:group>
        </xe:group>
      </xe:group>

      <!-- Workflow steps -->
      <xe:label style="label-title" value="${workflow-steps}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:group align="right">
          <xe:button action="new-workflow-step"     icon="add"       tooltip="${new}"/>
          <xe:button action="edit-workflow-step"    icon="edit"      tooltip="${edit}"/>
          <xe:button action="delete-workflow-step"  icon="delete"    tooltip="${delete}"/>
          <xe:button action="copy-workflow-step"    icon="duplicate" tooltip="${duplicate}"/>
          <xe:button action="export-internal-table" icon="export"    tooltip="${export}"/>
        </xe:group>
          <xe:xe-table id="table" source="workflow_step" weight-x="1" height="300" double-click-action="table-double-click">
          <xe:columns>
            <xe:sorting>
              <xe:sort-col key="sorting" ascending="true"/>
            </xe:sorting>
            <xe:column key="enabled" label="${enabled}" source="@enabled" width="6em" type="bool"/>
            <xe:column key="id" label="${id}" source="@wf_step" width="10em"/>
            <xe:column key="name" label="${name}" source="@name" width="20em"/>
            <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
            <xe:column key="colour" label="${colour}" type="color" source="@color" width="6em"/>
            <xe:column key="completion" label="${completion}" formula=":if (workflow_step/@completion_percentage) then concat(workflow_step/@completion_percentage, '%') else ()" align="right" width="10em"/>
            <xe:column key="sorting" label="${sorting}" source="@sorting" align="right" width="7em"/>
            <xe:column key="wf_state" label="${state}" formula=":cs:cachelookup('workflow_state','@id',workflow_step/@wf_state_id)/@name" align="right" width="15em"/>
          </xe:columns>
        </xe:xe-table>
      </xe:group>

    </xe:group>
  </xe:part>

  <!-- EDIT WORKFLOW STEPS DIALOG -->
 <xe:part id="edit-record-workflow-steps" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <!-- validate-on-keystroke does not work here -->
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down">
          <xe:editfield label="${id}" label-style="label-default" width="50" source="@wf_step" data-type="INTEGER" id="pk" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false' or @rowid!=null" validate-on-keystroke="true">
            <xe:validate not-null="true"/>
            <!-- the following fails for editing an not yet persisted step, the id is regarded as duplicate  -->
            <!-- <xe:validate condition="=lookup('$current.workflow.workflow_step','@wf_step',@wf_step)=null"/> -->
          </xe:editfield>
          <xe:include key="localized-name-required-overwrite"/>
          <xe:include key="localized-description-overwrite"/>
          <xe:editfield label="${sorting}" label-style="label-default" width="10em" source="@sorting" data-type="INTEGER"  readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
            <xe:validate not-null="true"/>
          </xe:editfield>
          <xe:group align="right" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
            <xe:editfield label="${completion-state}" label-style="label-default" width="10em" source="@completion_percentage" data-type="NUMBER">
              <xe:validate not-null="true"/>
            </xe:editfield>
            <xe:label value="%"/>
          </xe:group>
          <xe:group align="right" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
            <xe:colorpicker label="${colour}" label-style="label-default" source="@color"/>
            <xe:deletebutton source="@color"/>
          </xe:group>
          <xe:popupmenu label="${state}" label-style="label-default" width="30em" source="@wf_state_id" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
            <xe:options label-key="@name" value-key="@id">
              <xe:generator name="cachedtables" table-name="workflow_state"/>
              <xe:sort key="@name" ascending="true"/>
            </xe:options>
            <xe:validate not-null="true"/>
          </xe:popupmenu>
          <xe:group align="right" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
            <xe:popupmenu label="${default-target}" label-style="label-default" width="30em" source="@def_party" sort="ascending">
              <xe:options label-key="@display_name" value-key="@id">
                <xe:generator name="cachedtables" table-name="party"/>
                <xe:sort key="@display_name" ascending="true"/>
              </xe:options>
            </xe:popupmenu>
            <xe:deletebutton source="@def_party"/>
          </xe:group>
      <!-- not persisted workflowsteps are not in the Cached-Tables.
           Hence newly entered steps have the whole workflow including its steps with them -->
          <xe:group align="right" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
            <xe:popupmenu label="${checkedout-step}" label-style="label-default" width="30em" source="@checked_out_step">
              <xe:options source="$current.workflow.workflow_step" label-key="@name" value-key="@wf_step">
                <!-- <xe:sort key="@name" ascending="true"/> -->
                <xe:sort key="@sorting" data-type="integer" ascending="true"/>
              </xe:options>
            </xe:popupmenu>
            <xe:deletebutton source="@checked_out_step"/>
          </xe:group>
          <xe:group align="right" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
            <xe:popupmenu label="${trigger-event}" label-style="label-default" width="30em" source="@async_event">
              <xe:options label-key="@description" value-key="@event_key">
                <xe:generator name="cachedtables" table-name="event"/>
                <xe:filter source="@eventsource" operator="=" match="CustomAssetEvent"/>
                <xe:sort key="@description" ascending="true"/>
              </xe:options>
            </xe:popupmenu>
            <xe:deletebutton source="@async_event"/>
          </xe:group>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- WORKFLOW STATES TABLE DIALOG -->
  <xe:part id="table-list-workflow-states" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="workflow_states.workflow_state" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@id" width="6em" align="right" filterable="true" type="number"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="colour" label="${colour}" type="color" source="@color" width="6em" filterable="false"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT WORKFLOW STATES DIALOG -->
  <xe:part id="edit-record-workflow-states" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
       <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down">
          <xe:editfield label="${id}" label-style="label-default" width="10em" source="@id" data-type="INTEGER" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
              <xe:validate not-empty="true" regex="^*[1-9][0-9]*$"/>
          </xe:editfield>
          <xe:include key="localized-name-required-overwrite"/>
          <xe:include key="localized-description-overwrite"/>
          <xe:group align="right">
            <xe:colorpicker label="${colour}" label-style="label-default" source="@color" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'"/>
            <xe:deletebutton source="@color"/>
          </xe:group>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- DOMAINS TABLE DIALOG -->
  <xe:part id="table-list-domains" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="domains.domain" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@pathid" width="25em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="sorting" label="${sorting}" source="@sorting" width="7em" align="right" filterable="false"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT DOMAINS DIALOG -->
  <xe:part id="edit-record-domains" transactional="true">
    <xe:inititems>
      <xe:inititem dest="@pathid" value="root."/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:popupmenutree label="${parent-domain}" label-style="label-default" source="@parent" hide-root-popup="false">
            <xe:treeoptions label-key="@name" value-key="@pathid">
              <xe:generator name="cachedtables" table-name="domain"/>
              <xe:sort key="@sorting" data-type="integer"/>
            </xe:treeoptions>
          </xe:popupmenutree>
          <xe:editfield label="${value}" label-style="label-default" width="30em" source="@shortname">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*" condition="=:empty(cs:cachelookup('domain')/domain[lower-case(@shortname) = lower-case($content/domain/@shortname) and @parent = $content/domain/@parent and (not($content/domain/@rowid) or @rowid != $content/domain/@rowid)])"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:editfield label="${sorting}" label-style="label-default" width="10em" source="@sorting" data-type="INTEGER" defaultvalue="1">
            <xe:validate not-empty="true"/>
          </xe:editfield>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- DOMAIN2S TABLE DIALOG -->
  <xe:part id="table-list-domain2s" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="domain2s.domain2" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@pathid" width="25em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="sorting" label="${sorting}" source="@sorting" width="7em" align="right" filterable="false"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT DOMAIN2S DIALOG -->
  <xe:part id="edit-record-domain2s" transactional="true">
    <xe:inititems>
      <xe:inititem dest="@pathid" value="root."/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:popupmenutree label="${parent-domain}" label-style="label-default" source="@parent" hide-root-popup="false">
            <xe:treeoptions label-key="@name" value-key="@pathid">
              <xe:generator name="cachedtables" table-name="domain2"/>
              <xe:sort key="@sorting" data-type="integer"/>
            </xe:treeoptions>
          </xe:popupmenutree>
          <xe:editfield label="${value}" label-style="label-default" width="30em" source="@shortname">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*" condition="=:empty(cs:cachelookup('domain2')/domain2[lower-case(@shortname) = lower-case($content/domain2/@shortname) and @parent = $content/domain2/@parent and (not($content/domain2/@rowid) or @rowid != $content/domain2/@rowid)])"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:editfield label="${sorting}" label-style="label-default" width="10em" source="@sorting" data-type="INTEGER">
            <xe:validate not-empty="true"/>
          </xe:editfield>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- ASSET FORMAT TABLE DIALOG -->
  <xe:part id="table-list-asset-formats" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="asset_formats.asset_format" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="name" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@id" width="15em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="asset-type" label="${asset-type}" width="15em" filterable="true" formula="cachelookup('asset_typedef', '@asset_type', @asset_type)@name"/>
          <xe:column key="column-count" label="${column-count}" source="@column_count" width="10em" filterable="true"/>
          <xe:column key="width" label="${width}" source="@paper_width_mm" width="10em" filterable="false"/>
          <xe:column key="height" label="${height}" source="@paper_height_mm" width="10em" filterable="false"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT ASSET FORMATS DIALOG -->
  <xe:part id="edit-record-asset-formats" transactional="true">
    <xe:inititems>
      <!--
          presets for the domain fields:
          you can only choose domains equal or lower than the users main-domains.
          the validation to suppress domains is done in a validation-listener.
      -->
      <!-- Slots are defined in the interface Slots -->
      <xe:inititem dest="@domain"  value="=$system.party@main_domain"  overwrite="false"/>
      <xe:inititem dest="@domain2" value="=$system.party@main_domain2" overwrite="false"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@id">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:checkbox label="${double-sided}" label-style="label-default" checked-value="1" unchecked-value="0" source="@doublesided"/>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
          <xe:include key="domains-required"/>
          <xe:group align="right">
            <xe:popupmenutree label="${asset-type}" label-style="label-default" source="@asset_type" hide-root-popup="false" sort="ascending">
              <xe:treeoptions label-key="@name" value-key="@asset_type">
                <xe:generator name="cachedtables" table-name="asset_typedef"/>
              </xe:treeoptions>
            </xe:popupmenutree>
            <xe:deletebutton source="@asset_type"/>
          </xe:group>
          <xe:group align="right">
            <xe:editfield label="${area-fraction}" label-style="label-default" width="10em" source="@page_percentage" data-type="NUMBER"/>
            <xe:label value="%"/>
          </xe:group>
          <xe:group align="right">
            <xe:group align="down">
              <xe:group align="right">
                <xe:editfield label="${width}" label-style="label-default" width="10em" source="@paper_width_mm" data-type="NUMBER">
                  <xe:validate not-empty="true"/>
                </xe:editfield>
                <xe:label value="${mm}"/>
              </xe:group>
              <xe:group align="right">
                <xe:editfield label="${height}" label-style="label-default" width="10em" source="@paper_height_mm" data-type="NUMBER">
                  <xe:validate not-empty="true"/>
                </xe:editfield>
                <xe:label value="${mm}"/>
              </xe:group>
              <xe:group align="right">
                <xe:editfield label="${margin-inside}" label-style="label-default" width="10em" source="@margin_inside_mm" data-type="NUMBER" defaultvalue="0"/>
                <xe:label value="${mm}"/>
              </xe:group>
              <xe:group align="right">
                <xe:editfield label="${margin-outside}" label-style="label-default" width="10em" source="@margin_outside_mm" data-type="NUMBER" defaultvalue="0"/>
                <xe:label value="${mm}"/>
              </xe:group>
              <xe:group align="right">
                <xe:editfield label="${margin-top}" label-style="label-default" width="10em" source="@margin_top_mm" data-type="NUMBER" defaultvalue="0"/>
                <xe:label value="${mm}"/>
              </xe:group>
              <xe:group align="right">
                <xe:editfield label="${margin-bottom}" label-style="label-default" width="10em" source="@margin_bottom_mm" data-type="NUMBER" defaultvalue="0"/>
                <xe:label value="${mm}"/>
              </xe:group>
              <xe:editfield label="${column-count}" label-style="label-default" width="10em" source="@column_count" data-type="INTEGER" defaultvalue="1">
                <xe:change dest="@column_count" value="=:max((xs:integer(asset_format/@column_count), 1))"/>
              </xe:editfield>
              <xe:group align="right">
                <xe:editfield label="${column-gutter}" label-style="label-default" width="10em" source="@column_gutter_mm" data-type="NUMBER" defaultvalue="0"/>
                <xe:label value="${mm}"/>
              </xe:group>
              <xe:group align="right">
                <xe:editfield label="${column-width}" label-style="label-default" width="10em" source="@column_width_mm" data-type="NUMBER" defaultvalue="=:((xs:double(asset_format/@column_width_mm) + xs:double(asset_format/@column_gutter_mm)) * xs:integer(asset_format/@column_count)) - xs:double(asset_format/@column_gutter_mm) + xs:double(asset_format/@margin_inside_mm) + xs:double(asset_format/@margin_outside_mm)">
                  <xe:change dest="@paper_width_mm" value="=:((xs:double(asset_format/@column_width_mm) + xs:double(asset_format/@column_gutter_mm)) * xs:integer(asset_format/@column_count)) - xs:double(asset_format/@column_gutter_mm) + xs:double(asset_format/@margin_inside_mm) + xs:double(asset_format/@margin_outside_mm)"/>
                  <xe:listen-to source="@paper_width_mm">
                    <xe:listen-to source="@column_count">
                      <xe:listen-to source="@column_gutter_mm">
                        <xe:listen-to source="@margin_inside_mm">
                          <xe:listen-to source="@margin_outside_mm">
                            <xe:change dest="@column_width_mm" value="=:((xs:double(asset_format/@paper_width_mm) - xs:double(asset_format/@margin_inside_mm) - xs:double(asset_format/@margin_outside_mm) + xs:double(asset_format/@column_gutter_mm)) div xs:double(asset_format/@column_count)) - xs:double(asset_format/@column_gutter_mm)"/>
                          </xe:listen-to>
                        </xe:listen-to>
                      </xe:listen-to>
                    </xe:listen-to>
                  </xe:listen-to>
                </xe:editfield>
                <xe:label value="${mm}"/>
              </xe:group>
              <xe:editfield label="${row-count}" label-style="label-default" width="10em" source="@row_count" data-type="INTEGER" defaultvalue="1">
                <xe:change dest="@row_count" value="=:max((xs:integer(asset_format/@row_count), 1))"/>
              </xe:editfield>
              <xe:group align="right">
                <xe:editfield label="${row-gutter}" label-style="label-default" width="10em" source="@row_gutter_mm" data-type="NUMBER" defaultvalue="0"/>
                <xe:label value="${mm}"/>
              </xe:group>
              <xe:group align="right">
                <xe:editfield label="${row-height}" label-style="label-default" width="10em" source="@row_height_mm" data-type="NUMBER" defaultvalue="=:((xs:double(asset_format/@row_height_mm) + xs:double(asset_format/@row_gutter_mm)) * xs:integer(asset_format/@row_count)) - xs:double(asset_format/@row_gutter_mm) + xs:double(asset_format/@margin_top_mm) + xs:double(asset_format/@margin_bottom_mm)">
                  <xe:change dest="@paper_height_mm" value="=:((xs:double(asset_format/@row_height_mm) + xs:double(asset_format/@row_gutter_mm)) * xs:integer(asset_format/@row_count)) - xs:double(asset_format/@row_gutter_mm) + xs:double(asset_format/@margin_top_mm) + xs:double(asset_format/@margin_bottom_mm)"/>
                  <xe:listen-to source="@paper_height_mm">
                    <xe:listen-to source="@row_count">
                      <xe:listen-to source="@row_gutter_mm">
                        <xe:listen-to source="@margin_top_mm">
                          <xe:listen-to source="@margin_bottom_mm">
                            <xe:change dest="@row_height_mm" value="=:((xs:double(asset_format/@paper_height_mm) - xs:double(asset_format/@margin_top_mm) - xs:double(asset_format/@margin_bottom_mm) + xs:double(asset_format/@row_gutter_mm)) div xs:double(asset_format/@row_count)) - xs:double(asset_format/@row_gutter_mm)"/>
                          </xe:listen-to>
                        </xe:listen-to>
                      </xe:listen-to>
                    </xe:listen-to>
                  </xe:listen-to>
                </xe:editfield>
                <xe:label value="${mm}"/>
              </xe:group>
            </xe:group>
            <xe:strut width="3em"/>
            <xe:groupbox caption="${preview}" align-y="top">
              <xe:html width="400" height="300" margin="0" css-key="asset-info" align-y="top">
                <xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:my="http://www.censhare.com" version="2.0">
                  <xsl:param name="system"/>
                  <xsl:variable name="targetWidth" select="400"/>
                  <xsl:variable name="targetHeight" select="300"/>
                  <xsl:variable name="margin" select="6"/>
                  <xsl:variable name="doubleSided" select="asset_format/@doublesided = '1'"/>
                  <xsl:variable name="paperWidthMM" select="xs:double(asset_format/@paper_width_mm)"/>
                  <xsl:variable name="paperHeightMM" select="xs:double(asset_format/@paper_height_mm)"/>
                  <xsl:variable name="marginInsideMM" select="xs:double(asset_format/@margin_inside_mm)"/>
                  <xsl:variable name="marginOutsideMM" select="xs:double(asset_format/@margin_outside_mm)"/>
                  <xsl:variable name="marginTopMM" select="xs:double(asset_format/@margin_top_mm)"/>
                  <xsl:variable name="marginBottomMM" select="xs:double(asset_format/@margin_bottom_mm)"/>
                  <xsl:variable name="columnCount" select="if (asset_format/@column_count) then xs:integer(asset_format/@column_count) else 1"/>
                  <xsl:variable name="columnGutterMM" select="xs:double(asset_format/@column_gutter_mm)"/>
                  <xsl:variable name="columnWidthMM" select="if (asset_format/@column_width_mm) then xs:double(asset_format/@column_width_mm) else (($paperWidthMM - $marginInsideMM - $marginOutsideMM + $columnGutterMM) div $columnCount) - $columnGutterMM"/>
                  <xsl:variable name="rowCount" select="if (asset_format/@row_count) then xs:integer(asset_format/@row_count) else 1"/>
                  <xsl:variable name="rowGutterMM" select="xs:double(asset_format/@row_gutter_mm)"/>
                  <xsl:variable name="rowHeightMM" select="if (asset_format/@row_height_mm) then xs:double(asset_format/@row_height_mm) else (($paperHeightMM - $marginTopMM - $marginBottomMM + $rowGutterMM) div $rowCount) - $rowGutterMM"/>
                  <xsl:variable name="factor" select="min((($targetWidth - ($margin * 2)) div (if ($doubleSided) then $paperWidthMM * 2 else $paperWidthMM), ($targetHeight - ($margin * 2)) div $paperHeightMM))"/>
                  <xsl:template match="/">
                    <html>
                      <xsl:if test="$paperWidthMM and $paperHeightMM">
                        <table cellpadding="0" cellspacing="0">
                          <tr>
                            <xsl:if test="$doubleSided">
                              <td>
                                <xsl:copy-of select="my:getPageElement('left')"/>
                              </td>
                            </xsl:if>
                            <td>
                              <xsl:copy-of select="my:getPageElement('right')"/>
                            </td>
                          </tr>
                        </table>
                      </xsl:if>
                    </html>
                  </xsl:template>
                  <xsl:function name="my:getPageElement">
                    <xsl:param name="side" as="xs:string"/>
                    <table cellpadding="0" cellspacing="0" style="width:{round(($paperWidthMM - $marginInsideMM - $marginOutsideMM) * $factor)}; height:{round(($paperHeightMM - $marginTopMM - $marginBottomMM) * $factor)}; padding-left:{round((if ($side = 'right') then $marginInsideMM else $marginOutsideMM) * $factor)}; padding-top:{round($marginTopMM * $factor)}; padding-right:{round((if ($side='right') then $marginOutsideMM else $marginInsideMM) * $factor)}; padding-bottom:{round($marginBottomMM * $factor)}; background-color:white; border-style:solid; border-width:1; border-color:gray;">
                      <tr>
                        <td>
                          <!-- rows -->
                          <xsl:for-each select="1 to $rowCount">
                            <table cellpadding="0" cellspacing="0" style="margin-bottom:{if (. lt $rowCount) then round($rowGutterMM * $factor) else 0}">
                              <tr>
                                <!-- columns -->
                                <xsl:for-each select="1 to $columnCount">
                                  <td style="width:{round($columnWidthMM * $factor)}; height:{round($rowHeightMM * $factor)}; border-style:solid; border-width:1; border-color:blue;"/>
                                  <!-- column gutter -->
                                  <xsl:if test=". lt $columnCount">
                                    <td style="width:{round($columnGutterMM * $factor)};"/>
                                  </xsl:if>
                                </xsl:for-each>
                              </tr>
                            </table>
                          </xsl:for-each>
                        </td>
                      </tr>
                    </table>
                  </xsl:function>
                </xsl:stylesheet>
              </xe:html>
            </xe:groupbox>
          </xe:group>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- COLOR TABLE DIALOG -->
  <xe:part id="table-list-colors" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="colors.color" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="name" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@id" width="15em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="monitor-color" label="${monitor-color}" type="color" source="@screencolor" width="10em" filterable="false"/>
          <xe:column key="cyan" label="${cyan}" width="6em" align="right" filterable="false" formula=":if (color/@cyan) then concat(color/@cyan, '%') else ''"/>
          <xe:column key="magenta" label="${magenta}" width="6em" align="right" filterable="false" formula=":if (color/@magenta) then concat(color/@magenta, '%') else ''"/>
          <xe:column key="yellow" label="${yellow}" width="6em" align="right" filterable="false" formula=":if (color/@yellow) then concat(color/@yellow, '%') else ''"/>
          <xe:column key="black" label="${black}" width="6em" align="right" filterable="false" formula=":if (color/@black) then concat(color/@black, '%') else ''"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT COLOR DIALOG -->
  <xe:part id="edit-record-colors" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" source="@id" width="30em">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
          <xe:include key="domains-required"/>
          <xe:colorpicker label="${monitor-color}" source="@screencolor" label-style="label-default"/>
        </xe:group>
      </xe:group>
      <xe:label style="label-title" value="${print-color}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:group align="right">
          <xe:editfield label="${cyan}" label-style="label-default" source="@cyan" width="10em" tooltip="${color-tooltip}" data-type="NUMBER(4,1)">
            <xe:validate min-value="0.0" max-value="100.0"/>
          </xe:editfield>
          <xe:label value="%"/>
        </xe:group>
        <xe:group align="right">
          <xe:editfield label="${magenta}" label-style="label-default" source="@magenta" width="10em" tooltip="${color-tooltip}" data-type="NUMBER(4,1)">
            <xe:validate min-value="0.0" max-value="100.0"/>
          </xe:editfield>
         <xe:label value="%"/>
        </xe:group>
        <xe:group align="right">
          <xe:editfield label="${yellow}" label-style="label-default" source="@yellow" width="10em" tooltip="${color-tooltip}" data-type="NUMBER(4,1)">
            <xe:validate min-value="0.0" max-value="100.0"/>
          </xe:editfield>
          <xe:label value="%"/>
        </xe:group>
        <xe:group align="right">
          <xe:editfield label="${black}" label-style="label-default" source="@black" width="10em" tooltip="${color-tooltip}" data-type="NUMBER(4,1)">
            <xe:validate min-value="0.0" max-value="100.0"/>
          </xe:editfield>
          <xe:label value="%"/>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- MIMETYPES TABLE DIALOG -->
  <xe:part id="table-list-mimetypes" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="mimetypes.mimetype" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="name" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@mimetype" width="25em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="25em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="file-extension" label="${file-extension}" source="@extension" width="15em" filterable="true"/>
          <xe:column key="asset-type" label="${asset-type}" width="15em" filterable="true" formula="cachelookup('asset_typedef', '@asset_type', @def_assettype)@name"/>
          <xe:column key="asset-application" label="${asset-application}" width="15em" filterable="true" formula="cachelookup('asset_application', '@id', @def_application)@name"/>
          <xe:column key="mac-file-type" label="${mac-file-type}" source="@mactype" width="10em" filterable="false"/>
          <xe:column key="mac-creator-type" label="${mac-creator-type}" source="@maccreator" width="10em" filterable="false"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT MIMETYPES DIALOG -->
  <xe:part id="edit-record-mimetypes" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@mimetype">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:editfield label="${file-extension}" label-style="label-default" width="30em" source="@extension">
            <xe:validate not-empty="true" regex="\..+"/>
          </xe:editfield>
          <xe:editfield label="${mac-file-type}" label-style="label-default" width="10em" source="@mactype">
            <xe:validate not-empty="true" regex=".{0,4}"/>
          </xe:editfield>
          <xe:editfield label="${mac-creator-type}" label-style="label-default" width="10em" source="@maccreator">
            <xe:validate not-empty="true" regex=".{0,4}"/>
          </xe:editfield>
          <xe:checkbox label="${mac-osx-bundle-file}" label-style="label-default" checked-value="1" unchecked-value="0" source="@is_osx_bundle"/>
          <xe:group align="right">
            <xe:popupmenutree label="${asset-type}" label-style="label-default" source="@def_assettype" hide-root-popup="false" sort="ascending">
              <xe:treeoptions label-key="@name" value-key="@asset_type">
                <xe:generator name="cachedtables" table-name="asset_typedef"/>
              </xe:treeoptions>
            </xe:popupmenutree>
            <xe:deletebutton source="@def_assettype"/>
          </xe:group>
          <xe:group align="right">
            <xe:popupmenu label="${asset-application}" label-style="label-default" width="30em" source="@def_application" sort="ascending">
              <xe:options label-key="@name" value-key="@id">
                <xe:generator name="cachedtables" table-name="asset_application"/>
              </xe:options>
            </xe:popupmenu>
            <xe:deletebutton source="@def_application"/>
          </xe:group>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
        </xe:group>
      </xe:group>
      <!-- Identifications -->
      <xe:label style="label-title" value="${identifications}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:foreach source="mimetype_alt" align="down" not-empty="true">
          <xe:group align="down">
            <xe:group align="right">
              <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
                <xe:validate not-null="true"/>
              </xe:checkbox>
              <xe:deletebutton/>
            </xe:group>
            <xe:group align="down">
              <xe:readonly-filters>
                <xe:filter source="@tcn" operator="not-null"/>
              </xe:readonly-filters>
              <xe:editfield label="${file-extension}" label-style="label-default" width="30em" source="@extension">
                <xe:validate not-null="true" regex="\..+"/>
              </xe:editfield>
              <xe:editfield label="${mac-file-type}" label-style="label-default" width="30em" source="@mactype">
                <xe:validate not-null="true" regex=".{0,4}"/>
              </xe:editfield>
              <xe:editfield label="${mac-creator-type}" label-style="label-default" width="30em" source="@maccreator">
                <xe:validate not-null="true" regex=".{0,4}"/>
              </xe:editfield>
            </xe:group>
            <xe:edittext label="${magic-byte-pattern}" label-style="label-default" width="30em" scrollpane="false" rows="1" source="@magic_byte_pattern" tooltip="${mimetype-magic-byte-tooltip}">
              <xe:validate regex="([0-9]+.*)*"/>
            </xe:edittext>
            <xe:separator/>
          </xe:group>
        </xe:foreach>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- USER PARAMS TABLE DIALOG -->
  <xe:part id="table-list-user-params" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="user_params.user_param" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@id" width="6em" align="right" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="type" label="${type}" width="20em" filterable="true" formula="case(@key, 'assetsearch', '${asset-search}', 'assetfilter', '${asset-filter}', 'userprefs', '${web-client-user-setting}', 'schedule-step-filter', '${schedule-step-filter}', @key)"/>
          <xe:column key="party" label="${party}" width="20em" filterable="true" formula="cachelookup('party', '@id', @party_id)@display_name"/>
          <xe:column key="role" label="${role}" width="20em" filterable="true" formula="cachelookup('role', '@role', @role)@name"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT USER PARAMS DIALOG -->
  <xe:part id="edit-record-user-params" transactional="true">
    <xe:inititems>
      <!--
          presets for the domain fields:
          you can only choose domains equal or lower than the users main-domains.
          the validation to suppress domains is done in a validation-listener.
      -->
      <!-- Slots are defined in the interface Slots -->
      <xe:inititem dest="@domain"  value="=$system.party@main_domain"  overwrite="false"/>
      <xe:inititem dest="@domain2" value="=$system.party@main_domain2" overwrite="false"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="10em" source="@id" readonly="true"/>
          <xe:editfield label="${name}" label-style="label-default" width="30em" source="@name">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:popupmenu label="${type}" label-style="label-default" width="30em" source="@key">
            <xe:options>
              <xe:option label="${asset-search}" value="assetsearch"/>
              <xe:option label="${asset-filter}" value="assetfilter"/>
              <xe:option label="${web-client-user-setting}" value="userprefs"/>
              <xe:option label="${schedule-step-filter}" value="schedule-step-filter"/>
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
        </xe:group>
      </xe:group>
      <xe:label style="label-title" value="${shortcut}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:editfield label="Windows" label-style="label-default" width="30em" source="@shortcut_win" tooltip="${user-param-tooltip-win}"/>
        <xe:editfield label="Macintosh" label-style="label-default" width="30em" source="@shortcut_mac" tooltip="${user-param-tooltip-mac}"/>
      </xe:group>
      <xe:label style="label-title" value="${assignment}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:label value="${user-param-empty-entries-help}" weight-x="1"/>
        <xe:group align="right">
          <xe:popupmenu label="${party}" label-style="label-default" width="30em" source="@party_id" sort="ascending">
            <xe:options label-key="@display_name" value-key="@id">
              <xe:generator name="cachedtables" table-name="party"/>
            </xe:options>
          </xe:popupmenu>
          <xe:deletebutton source="@party_id"/>
        </xe:group>
        <xe:group align="right">
          <xe:popupmenu label="${role}" label-style="label-default" width="30em" source="@role" sort="ascending">
            <xe:options label-key="@name" value-key="@role">
              <xe:generator name="cachedtables" table-name="role"/>
            </xe:options>
          </xe:popupmenu>
          <xe:deletebutton source="@role"/>
        </xe:group>
        <xe:include key="domains-required"/>
      </xe:group>
      <xe:label style="label-title" value="${xml-data}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:displayxml prefwidth="30em" prefheight="150" weight-x="1" weight-y="1" border-width="1" source="params"/>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- ASSET DEL POLICIES TABLE DIALOG -->
  <xe:part id="table-list-asset-del-policies" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="asset_del_policys.asset_del_policy" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="asset-type" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="asset-type" label="${asset-type}" width="25em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(asset_del_policy/@asset_type, '\.')))) return cs:cachelookup('asset_typedef', '@asset_type', concat(string-join(subsequence(tokenize(asset_del_policy/@asset_type, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="mode" label="${mode}" width="20em" filterable="true" formula="case(@del_mode, '0', '${asset-del-delete-selected-versions}', '1', '${asset-del-keep-all-versions}', '2', '${asset-del-delete-all-versions}')" />
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT ASSET DEL POLICIES DIALOG -->
  <xe:part id="edit-record-asset-del-policies" transactional="true">
    <xe:inititems>
      <!--
          presets for the domain fields:
          you can only choose domains equal or lower than the users main-domains.
          the validation to suppress domains is done in a validation-listener.
      -->
      <!-- Slots are defined in the interface Slots -->
      <xe:inititem dest="@domain"  value="=$system.party@main_domain"  overwrite="false"/>
      <xe:inititem dest="@domain2" value="=$system.party@main_domain2" overwrite="false"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:popupmenutree label="${asset-type}" label-style="label-default" source="@asset_type" hide-root-popup="false" sort="ascending">
            <xe:treeoptions label-key="@name" value-key="@asset_type">
              <xe:generator name="cachedtables" table-name="asset_typedef"/>
            </xe:treeoptions>
            <xe:validate not-empty="true"/>
          </xe:popupmenutree>
          <xe:include key="domains-required"/>
          <xe:popupmenu label="${mode}" label-style="label-default" width="30em" source="@del_mode" defaultvalue="0">
            <xe:options>
              <xe:option label="${asset-del-delete-selected-versions}" value="0"/>
              <xe:option label="${asset-del-keep-all-versions}" value="1"/>
              <xe:option label="${asset-del-delete-all-versions}" value="2"/>
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:group align="right">
            <xe:label value="${asset-del-mode-delete-all-info1}" margin-left="17em" weight-x="1"
                      visible="=:if(asset_del_policy/@del_mode = 2) then true() else false()">
              <xe:listen-to source="@del_mode"/>
            </xe:label>
          </xe:group>
          <xe:group align="right">
            <xe:label value="${asset-del-mode-delete-all-info2}" margin-left="17em" weight-x="1"
                      visible="=:if(asset_del_policy/@del_mode = 2) then true() else false()">
              <xe:listen-to source="@del_mode"/>
            </xe:label>
          </xe:group>
          <xe:group align="right">
            <xe:label value="${versions}" style="label-default"/>
            <xe:popupmenu label="${asset-del-keep-marked-seconds1}" source="@keep_marked_sec" defaultvalue="86400">
              <xe:options>
                <xe:option label="10 mins" value="600"/>
                <xe:option label="15 mins" value="900"/>
                <xe:option label="30 mins" value="1800"/>
                <xe:option label="1 h" value="3600"/>
                <xe:option label="6 h" value="21600"/>
                <xe:option label="12 h" value="43200"/>
                <xe:option label="24 h" value="86400"/>
                <xe:option label="48 h" value="172800"/>
              </xe:options>
              <xe:validate not-empty="true"/>
            </xe:popupmenu>
            <xe:label value="${asset-del-keep-marked-seconds2}"/>
          </xe:group>
          <xe:group align="right">
            <xe:label value=" " style="label-default"/>
            <xe:editfield label="${asset-del-keep-first-versions1}" width="5em" source="@keep_first_versions" defaultvalue="1" tooltip="mandatory, use integer values">
              <xe:validate not-empty="true" regex="[0-9]+"/>
            </xe:editfield>
            <xe:label value="${asset-del-keep-first-versions2}" width="10em" weight-x="1"/>
            <xe:icon key="info" tooltip="${info-asset-policy}" width="3em" weight-x="1" />
          </xe:group>
          <xe:group align="right">
            <xe:label value=" " style="label-default"/>
            <xe:editfield label="${asset-del-keep-last-versions1}" width="5em" source="@keep_last_versions" defaultvalue="3" tooltip="mandatory, use integer values">
              <xe:validate not-empty="true" regex="[0-9]+"/>
            </xe:editfield>
            <xe:label value="${asset-del-keep-last-versions2}" width="10em" weight-x="1" />
            <xe:icon key="info" tooltip="${info-asset-policy}" width="3em" weight-x="1" />
          </xe:group>
          <xe:group align="right">
            <xe:label value=" " style="label-default"/>
            <xe:editfield label="${asset-del-keep-last-days1}" width="5em" source="@keep_last_days" defaultvalue="7" tooltip="mandatory, use integer values">
              <xe:validate not-empty="true" regex="[0-9]+"/>
            </xe:editfield>
            <xe:label value="${asset-del-keep-last-days2}" weight-x="1"/>
          </xe:group>
          <xe:group align="right" margin-top="1em">
            <xe:label value="" style="label-default"/>
            <xe:label value="${note-asset-policy}" weight-x="1"/>
          </xe:group>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- ASSET TYPES TABLE DIALOG -->
  <xe:part id="table-list-asset-types" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="asset_typedefs.asset_typedef" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@asset_type" width="25em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="colour" label="${colour}" type="color" source="@color" width="6em" filterable="false"/>
          <xe:column key="files" label="${files}" width="15em" filterable="false" formula="case(@hasfiles, '0', '${no-files-allowed}', '1', '${files-allowed}', '2', '${files-necessary}')"/>
          <xe:column key="asset-application" label="${asset-application}" width="15em" filterable="true" formula="cachelookup('asset_application', '@id', @def_application)@name"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT ASSET TYPES DIALOG -->
  <xe:part id="edit-record-asset-types" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:editfield label="${id}" label-style="label-default" width="30em" source="@asset_type" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:validate not-empty="true" /> <!-- validation is made in HierarchicalTypeValidationListener -->
        </xe:editfield>
        <xe:include key="localized-name-required-overwrite"/>
        <xe:include key="localized-description-overwrite"/>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:include key="domains-required"/>
          <xe:group align="right">
            <xe:colorpicker label="${colour}" label-style="label-default" source="@color"/>
            <xe:deletebutton source="@color"/>
          </xe:group>
          <xe:popupmenu label="${files}" label-style="label-default" width="30em" source="@hasfiles" defaultvalue="1">
            <xe:options>
              <xe:option label="${no-files-allowed}" value="0"/>
              <xe:option label="${files-allowed}" value="1"/>
              <xe:option label="${files-necessary}" value="2"/>
            </xe:options>
          </xe:popupmenu>
          <xe:group align="right">
            <xe:popupmenu label="${asset-application}" label-style="label-default" width="30em" source="@def_application" sort="ascending" defaultvalue="default">
              <xe:options label-key="@name" value-key="@id">
                <xe:generator name="cachedtables" table-name="asset_application"/>
              </xe:options>
            </xe:popupmenu>
            <xe:deletebutton source="@def_application"/>
          </xe:group>
          <xe:foreach-locale align="down">
            <xe:edittext label-style="label-default" label="${element-name} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@element_name"/>
          </xe:foreach-locale>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- ASSET REL TYPES TABLE DIALOG -->
  <xe:part id="table-list-asset-rel-types" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="asset_rel_typedefs.asset_rel_typedef" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@key" width="25em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="parent-title" label="${parent-title}" source="@parent_name" width="20em" filterable="true"/>
          <xe:column key="child-title" label="${child-title}" source="@child_name" width="20em" filterable="true"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT ASSET REL TYPES DIALOG -->
  <xe:part id="edit-record-asset-rel-types" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:editfield label="${id}" label-style="label-default" width="30em" source="@key" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:validate not-empty="true"/>
        </xe:editfield>
        <xe:include key="localized-name-required-overwrite"/>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:foreach-locale>
            <xe:group align="down">
              <xe:edittext label-style="label-default" label="${parent-title} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@parent_name"/>
              <xe:edittext label-style="label-default" label="${child-title} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@child_name"/>
            </xe:group>
          </xe:foreach-locale>
        </xe:group>
        <xe:include key="localized-description-overwrite"/>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:include key="domains-required"/>
          <xe:editfield label="${parent-sorting}" label-style="label-default" width="10em" source="@parent_sort" data-type="INTEGER" defaultvalue="1">
            <xe:validate not-null="true"/>
          </xe:editfield>
          <xe:editfield label="${child-sorting}" label-style="label-default" width="10em" source="@child_sort" data-type="INTEGER" defaultvalue="1">
            <xe:validate not-null="true"/>
          </xe:editfield>
          <xe:popupmenu label="${type}" label-style="label-default" source="@kind" width="30em" defaultvalue="0">
            <xe:options>
              <xe:option label="${directed}" value="0"/>
              <xe:option label="${not-directed}" value="1"/>
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:popupmenu label="${usage}" label-style="label-default" source="@cardinality" width="30em" defaultvalue="0">
            <xe:options>
              <xe:option label="1:1" value="1"/>
              <xe:option label="1:m" value="2"/>
              <xe:option label="n:1" value="3"/>
              <xe:option label="n:m" value="0"/>
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:checkbox label="" label-style="label-default" caption="${versioned}" source="@isversioned" checked-value="1" unchecked-value="0"/>
          <xe:checkbox label="" label-style="label-default" caption="${user-editable}" source="@is_user_editable" checked-value="1" unchecked-value="0"/>
          <xe:group align="right">
            <xe:label label="${filters}" label-style="label-default" align-y="top"/>
            <xe:group align="down">
              <xe:foreach source="match_criteria.entry">
                <xe:group align="down">
                  <xe:checkbox caption="${prioritized}" checked-value="1" unchecked-value="0" defaultvalue="0" source="@priority"/>
                  <xe:group align="right">
                    <xe:group align="down">
                      <xe:label value="${parent-asset}"/>
                      <xe:group align="right">
                        <xe:edit-query width="30em" height="60" dialog-type="dialog-asset-filter" source="parent-query" expression-id="edit-query"/>
                        <xe:deletebutton source="parent-query" align-y="top"/>
                      </xe:group>
                    </xe:group>
                    <xe:group align="down">
                      <xe:label value="${child-asset}"/>
                      <xe:group align="right">
                        <xe:edit-query width="30em" height="60" dialog-type="dialog-asset-filter" source="child-query" expression-id="edit-query"/>
                        <xe:deletebutton source="child-query" align-y="top"/>
                      </xe:group>
                    </xe:group>
                  </xe:group>
                  <xe:deletebutton/>
                  <xe:separator/>
                </xe:group>
              </xe:foreach>
            </xe:group>
          </xe:group>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- ASSET APPLICATIONS TABLE DIALOG -->
  <xe:part id="table-list-asset-applications" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="asset_applications.asset_application" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@id" width="15em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="edit-in-default-application" label="${edit-in-default-application}" align="left" type="bool" source="@allow_def_app" width="25em" filterable="false"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT ASSET APPLICATIONS DIALOG -->
  <xe:part id="edit-record-asset-applications" transactional="true">
    <xe:inititems>
      <xe:inititem dest="@allow_def_app" value="0"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@id">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
          <xe:checkbox label="${edit}" label-style="label-default" caption="${edit-in-default-application-allowed}" source="@allow_def_app" checked-value="1" unchecked-value="0">
            <xe:validate not-empty="true"/>
          </xe:checkbox>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- ROLE TABLE DIALOG -->
  <xe:part id="table-list-roles" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="roles.role" double-click-action="table-double-click"
        weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@role" width="20em" filterable="true" />
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="30em" filterable="false"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT ROLE DIALOG -->
  <xe:part id="edit-record-roles" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@role">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
        </xe:group>
      </xe:group>
      <xe:label style="label-title" value="${permissions}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:foreach source="role_permission" not-empty="true">
          <xe:group align="down">
            <xe:group align="right">
              <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
                <xe:validate not-null="true"/>
              </xe:checkbox>
              <xe:deletebutton/>
            </xe:group>
            <xe:group align="right">
              <!-- choose permission -->
              <xe:popupmenu label="${permission-set}" label-style="label-default" source="@permission_set" width="30em" sort="ascending">
                <xe:options label-key="@name" value-key="@permission_set">
                  <xe:generator name="cachedtables" table-name="permission_set"/>
                </xe:options>
                <xe:validate not-empty="true"/>
              </xe:popupmenu>
            </xe:group>
            <xe:group align="right">
              <xe:popupmenu label="${role-permission-workflow-state-from}" label-style="label-default" source="@wf_state_from" width="30em" sort="ascending">
                <xe:options value-key="@id" label-key="@name">
                  <xe:generator name="cachedtables" table-name="workflow_state" source="@enabled" match="1"/>
                </xe:options>
                <xe:listen-to source="@wf_state_to"/>
              </xe:popupmenu>
              <xe:deletebutton source="@wf_state_from"/>
              <xe:popupmenu label="${role-permission-workflow-state-to}" source="@wf_state_to" width="30em" sort="ascending">
                <xe:options value-key="@id" label-key="@name">
                  <xe:generator name="cachedtables" table-name="workflow_state" source="@enabled" match="1"/>
                </xe:options>
                <xe:listen-to source="@wf_state_from"/>
              </xe:popupmenu>
              <xe:deletebutton source="@wf_state_to"/>
            </xe:group>
            <xe:group align="right">
              <xe:popupmenu label="${role-permission-workflow-target-state-from}" label-style="label-default" source="@wf_target_state_from" width="30em" sort="ascending">
                <xe:options value-key="@id" label-key="@name">
                  <xe:generator name="cachedtables" table-name="workflow_state" source="@enabled" match="1"/>
                </xe:options>
                <xe:listen-to source="@wf_target_state_to"/>
              </xe:popupmenu>
              <xe:deletebutton source="@wf_target_state_from"/>
              <xe:popupmenu label="${role-permission-workflow-target-state-to}" source="@wf_target_state_to" width="30em" sort="ascending">
                <xe:options value-key="@id" label-key="@name">
                  <xe:generator name="cachedtables" table-name="workflow_state" source="@enabled" match="1"/>
                </xe:options>
                <xe:listen-to source="@wf_target_state_from"/>
              </xe:popupmenu>
              <xe:deletebutton source="@wf_target_state_to"/>
            </xe:group>
          </xe:group>
        </xe:foreach>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- PERMISSION KEY TABLE DIALOG -->
  <xe:part id="table-list-access-rights" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="permission_keydefs.permission_keydef" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@key" width="25em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="30em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="30em" filterable="false"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT PERMISSION KEY DIALOG -->
  <xe:part id="edit-record-access-rights" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@key">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- PERMISSION SET TABLE DIALOG -->
  <xe:part id="table-list-permission-set" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="permission_sets.permission_set" double-click-action="table-double-click"
        weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@permission_set" width="20em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="false"/>
          <xe:column key="description" label="${description}" source="@description" width="30em" filterable="false"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT PERMISSION SET DIALOG -->
  <xe:part id="edit-record-permission-set" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@permission_set">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
        </xe:group>
      </xe:group>
      <xe:label style="label-title" value="${permission-keys}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="right" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:label label=" " label-style="label-default"/>
        <xe:group align="right">
          <xe:foreach source="permission_key" align="down" not-empty="true">
            <xe:inititems>
              <xe:inititem dest="@permission" value="1"/>
            </xe:inititems>
            <xe:sort expression="=cachelookup('permission_keydef', '@key', @key)@name"/>
            <xe:group align="right">
              <xe:popupmenu source="@key" sort="ascending">
                <xe:options label-key="@name" value-key="@key">
                  <xe:generator name="cachedtables" table-name="permission_keydef"/>
                  <!-- only show current key and not used permission keys -->
                  <xe:filter condition="=:permission_keydef/@key=$current/permission_key/@key or not(permission_keydef/@key=$content/permission_set/permission_key/@key)"/>
                </xe:options>
                <xe:validate not-empty="true"/>
              </xe:popupmenu>
              <xe:deletebutton/>
              <xe:checkbox caption="${enabled}" source="@permission" checked-value="1" unchecked-value="0"/>
            </xe:group>
          </xe:foreach>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- STORAGE KEY TABLE DIALOG -->
  <xe:part id="table-list-file-types" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="storage_keydefs.storage_keydef" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@key" width="20em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT STORAGE KEY DIALOG -->
  <xe:part id="edit-record-file-types" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@key">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- SCHEDULE TYPES TABLE DIALOG -->
  <xe:part id="table-list-schedule-types" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="schedule_step_typedefs.schedule_step_typedef" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@type" width="15em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="sorting" label="${sorting}" source="@sorting" align="right" width="7em"/>
          <xe:column key="colour" label="${colour}" type="color" source="@color" width="6em"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT SCHEDULE TYPES DIALOG -->
  <xe:part id="edit-record-schedule-types" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@type">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
          <xe:editfield label="${sorting}" label-style="label-default" width="10em" source="@sorting" data-type="INTEGER">
            <xe:validate not-null="true"/>
          </xe:editfield>
          <xe:group align="right">
            <xe:colorpicker label="${colour}" label-style="label-default" source="@color"/>
            <xe:deletebutton source="@color"/>
          </xe:group>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- LANGUAGES TABLE DIALOG -->
  <xe:part id="table-list-languages" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="language_defs.language_def" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@id" width="7em" filterable="true"/>
          <xe:column key="name" label="${name}" source="=:if ('' = '_de') then '@name_de' else '@name'" width="20em" filterable="true"/>
          <xe:column key="db-locale" label="${database}" source="@db_locale" width="15em" filterable="true"/>
          <xe:column key="indesign-locale" label="${adobe-indesign}" source="@indesign_locale" width="15em" filterable="true"/>
          <xe:column key="webcms-locale" label="${webcms}" source="@webcms_locale" width="15em" filterable="true"/>
          <xe:column key="javaclient-locale" label="${client}" source="@client_locale" width="15em" filterable="true"/>
          <xe:column key="tm-locale" label="${translation-memory}" source="@tm_locale" width="15em" filterable="true"/>
          <xe:column key="spellcheck-locale" label="${spell-check}" source="@spellcheck_locale" width="15em" filterable="true"/>
          <xe:column key="textsearch-locale" label="${full-text-search}" source="@textsearch_locale" width="15em" filterable="true"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT LANGUAGES DIALOG -->
  <xe:part id="edit-record-languages" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@id">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
          <xe:include key="domains-required"/>
        </xe:group>
      </xe:group>
      <xe:popupmenu source="@is_rtl" label="${writing-system}" label-style="label-default" sort="ascending" defaultvalue="0">
        <xe:options>
          <xe:option label="${ltr}" value="0"/>
          <xe:option label="${rtl}" value="1"/>
        </xe:options>
      </xe:popupmenu>
      <xe:groupbox caption="${assignments}" align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:popupmenu source="@db_locale" label="${database}" label-style="label-default" width="30em" tooltip="${database-locale-tooltip}" sort="ascending">
          <xe:options label-key="@name" value-key="@locale" null-entry="true">
            <xe:generator name="cachedtables" table-name="db_locale"/>
          </xe:options>
        </xe:popupmenu>
        <xe:popupmenu source="@webcms_locale" label="${webcms}" label-style="label-default" width="30em" tooltip="${webcms-locale-tooltip}" sort="ascending">
          <xe:options label-key="=:if (''='_de') then '@name_de' else '@name'" value-key="@locale" null-entry="true">
            <xe:generator name="cachedtables" table-name="java_locale"/>
          </xe:options>
        </xe:popupmenu>
        <xe:popupmenu source="@indesign_locale" label="${adobe-indesign}" label-style="label-default" width="30em" tooltip="${indesign-locale-tooltip}" sort="ascending">
          <xe:options label-key="=:if (''='_de') then '@name_de' else '@name'" value-key="@locale" null-entry="true">
            <xe:generator name="cachedtables" table-name="indesign_locale"/>
          </xe:options>
        </xe:popupmenu>
        <xe:popupmenu source="@client_locale" label="${client}" label-style="label-default" width="30em" tooltip="${client-locale-tooltip}" sort="ascending">
          <xe:options label-key="=:if (''='_de') then '@name_de' else '@name'" value-key="@locale" null-entry="true">
            <xe:generator name="cachedtables" table-name="java_locale"/>
          </xe:options>
        </xe:popupmenu>
        <xe:popupmenu source="@tm_locale" label="${translation-memory}" label-style="label-default" width="30em" tooltip="${translation-memory-locale-tooltip}" sort="ascending">
          <xe:options label-key="=:if (''='_de') then '@name_de' else '@name'" value-key="@locale" null-entry="true">
            <xe:generator name="cachedtables" table-name="java_locale"/>
          </xe:options>
        </xe:popupmenu>
        <xe:popupmenu source="@spellcheck_locale" label="${spell-check}" label-style="label-default" width="30em" tooltip="${spell-check-locale-tooltip}" sort="ascending">
          <xe:options label-key="=:if (''='_de') then '@name_de' else '@name'" value-key="@locale" null-entry="true">
            <xe:generator name="cachedtables" table-name="spellcheck_locale"/>
          </xe:options>
        </xe:popupmenu>
        <xe:popupmenu source="@textsearch_locale" label="${full-text-search}" label-style="label-default" width="30em" tooltip="${full-text-search-locale-tooltip}" sort="ascending">
          <xe:options label-key="=:if (''='_de') then '@name_de' else '@name'" value-key="@locale" null-entry="true">
            <xe:generator name="cachedtables" table-name="java_locale"/>
          </xe:options>
        </xe:popupmenu>
      </xe:groupbox>
    </xe:group>
  </xe:part>

  <!-- HOLIDAYS TABLE DIALOG -->
  <xe:part id="table-list-holidays" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="holiday_calendars.holiday_calendar" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="date" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="date" label="${date}" source="@holiday" width="20em" filterable="true" type="date" date-format="short" time-format="none"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT HOLIDAYS DIALOG -->
  <xe:part id="edit-record-holidays" transactional="true">
    <xe:inititems>
      <!--
          presets for the domain fields:
          you can only choose domains equal or lower than the users main-domains.
          the validation to suppress domains is done in a validation-listener.
      -->
      <!-- Slots are defined in the interface Slots -->
      <xe:inititem dest="@domain"  value="=$system.party@main_domain"  overwrite="false"/>
      <xe:inititem dest="@domain2" value="=$system.party@main_domain2" overwrite="false"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:date label="${date}" label-style="label-default" width="30em" source="@holiday" type="date">
            <xe:validate not-null="true"/>
          </xe:date>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
          <xe:include key="domains-required"/>
        </xe:group>
      </xe:group>
      <xe:label style="label-title" value="${regions}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="right" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:label label=" " label-style="label-default"/>
        <xe:group align="right">
          <xe:foreach source="holiday_calendar_region" align="down" not-empty="true">
            <!-- xe:sort expression="=cachelookup('region', '@pathid', @region)@name"/-->
            <xe:inititems>
              <xe:inititem dest="@region" value="root."/>
            </xe:inititems>
            <xe:group align="right">
              <xe:popupmenutree source="@region" hide-root-popup="false">
                <xe:treeoptions label-key="@name" value-key="@pathid">
                  <xe:generator name="cachedtables" table-name="region"/>
                  <xe:sort key="@sorting" data-type="integer"/>
                </xe:treeoptions>
              </xe:popupmenutree>
              <xe:deletebutton/>
            </xe:group>
          </xe:foreach>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- CLIENT VERSIONS TABLE DIALOG -->
  <xe:part id="table-list-client-versions" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="client_versions.client_version" double-click-action="table-double-click"
          weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="type" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="type" label="${type}" width="20em" filterable="true" formula="case(@type, 'javaclient', '${censhare-client}', 'webclient', '${censhare-web-client}', 'javaadmin', '${censhare-admin-client}', 'javarender', '${censhare-render-client}', 'service-client', '${censhare-service-client}', @type)"/>
          <xe:column key="version" label="${version}" source="@version_pattern" width="160" filterable="true"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT CLIENT VERSIONS DIALOG -->
  <xe:part id="edit-record-client-versions" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:popupmenu label="${type}" label-style="label-default" source="@type" width="30em">
            <xe:options>
              <xe:option label="${censhare-client}" value="javaclient"/>
              <xe:option label="${censhare-admin-client}" value="javaadmin"/>
              <xe:option label="${censhare-render-client}" value="javarender"/>
              <xe:option label="${censhare-service-client}" value="service-client"/>
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:editfield label="${version}" label-style="label-default" source="@version_pattern" width="10em">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:label label=" " label-style="label-default" value="${client-version-version-help}"/>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- FILESYSTEM DEF TABLE DIALOG -->
  <xe:part id="table-list-filesystem-def" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="filesystem_defs.filesystem_def" double-click-action="table-double-click"
        weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@name" width="20em" filterable="true" />
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="filesystem-type" label="${type}" width="20em" filterable="true" formula="case(@usage, 'temp', '${filesystem-type-temp}', 'assets', '${filesystem-type-assets}', 'archive', '${filesystem-type-archive}', 'offline-db', '${filesystem-type-offline-db}', 'spelling', '${filesystem-type-spelling}', 'client-software', '${filesystem-type-client-software}', 'error', '${filesystem-type-error}', 'other', '${filesystem-type-other}', @usage)"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT FILESYSTEM DEF DIALOG -->
  <xe:part id="edit-record-filesystem-def" transactional="true">
    <xe:inititems>
    <xe:inititem dest="@domain"  value="=$system.party@main_domain"  overwrite="false"/>
    <xe:inititem dest="@domain2" value="=$system.party@main_domain2" overwrite="false"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@name">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*"/>
          </xe:editfield>
          <xe:popupmenu label="${type}" label-style="label-default" width="30em" source="@usage" sort="ascending">
            <xe:options>
              <xe:option label="${filesystem-type-temp}" value="temp"/>
              <xe:option label="${filesystem-type-assets}" value="assets"/>
              <xe:option label="${filesystem-type-archive}" value="archive"/>
              <xe:option label="${filesystem-type-offline-db}" value="offline-db"/>
              <xe:option label="${filesystem-type-spelling}" value="spelling"/>
              <xe:option label="${filesystem-type-client-software}" value="client-software"/>
              <xe:option label="${filesystem-type-error}" value="error"/>
              <xe:option label="${filesystem-type-other}" value="other"/>
            </xe:options>
            <xe:validate not-empty="true"/>
            <xe:validate condition="=:empty(if (filesystem_def/@usage='other') then () else for $x in cs:cachelookup('filesystem_def', '@domain', */@domain, '@domain2', */@domain2, '@usage', */@usage) return if (*/@rowid and $x/@rowid=*/@rowid) then () else $x)"/>
          </xe:popupmenu>
          <xe:include key="localized-description"/>
          <xe:popupmenutree label="${domain}" label-style="label-default" source="@domain" hide-root-popup="false">
            <xe:treeoptions label-key="@name" value-key="@pathid">
              <xe:generator name="cachedtables" table-name="domain"/>
              <xe:sort key="@sorting" data-type="integer"/>
            </xe:treeoptions>
            <xe:validate not-empty="true"/>
            <xe:validate condition="=:empty(if (filesystem_def/@usage='other') then () else for $x in cs:cachelookup('filesystem_def', '@domain', */@domain, '@domain2', */@domain2, '@usage', */@usage) return if (*/@rowid and $x/@rowid=*/@rowid) then () else $x)"/>
          </xe:popupmenutree>
          <xe:popupmenutree label="${domain2}" label-style="label-default" source="@domain2" hide-root-popup="false">
            <xe:treeoptions label-key="@name" value-key="@pathid">
              <xe:generator name="cachedtables" table-name="domain2"/>
              <xe:sort key="@sorting" data-type="integer"/>
            </xe:treeoptions>
            <xe:validate not-empty="true"/>
            <xe:validate condition="=:empty(if (filesystem_def/@usage='other') then () else for $x in cs:cachelookup('filesystem_def', '@domain', */@domain, '@domain2', */@domain2, '@usage', */@usage) return if (*/@rowid and $x/@rowid=*/@rowid) then () else $x)"/>
          </xe:popupmenutree>
          <xe:group align="right">
            <xe:popupmenu label="${master-replication}" label-style="label-default" width="30em" source="@master" sort="ascending">
              <xe:options label-key="@replication_name" value-key="@replication_name">
                <xe:generator name="cachedtables" table-name="filesystem_repl_def" source="@name" match-source="$current@name"/>
              </xe:options>
            </xe:popupmenu>
            <xe:deletebutton source="@master"/>
          </xe:group>
          <xe:colorpicker label="${colour}" label-style="label-default" source="@color"/>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- FILESYSTEM REPL DEF TABLE DIALOG -->
  <xe:part id="table-list-filesystem-repl-def" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="filesystem_repl_defs.filesystem_repl_def" double-click-action="table-double-click"
        weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@replication_name" width="20em" filterable="true"/>
          <xe:column key="filesystem" label="${file-system}" source="@name" width="20em" filterable="true"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT FILESYSTEM REPL DEF DIALOG -->
  <xe:part id="edit-record-filesystem-repl-def" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:popupmenu label="${file-system}" label-style="label-default" width="30em" source="@name" sort="ascending">
            <xe:options label-key="@name" value-key="@name">
              <xe:generator name="cachedtables" table-name="filesystem_def"/>
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@replication_name">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-description"/>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- SERVER DEF TABLE DIALOG -->
  <xe:part id="table-list-server-def" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="server_defs.server_def" double-click-action="table-double-click"
        weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="30em" filterable="true"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT SERVER DEF DIALOG -->
  <xe:part id="edit-record-server-def" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@name">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:include key="localized-description"/>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- FEATURE TYPE -->
  <xe:part id="table-list-feature-types" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="feature_types.feature_type" double-click-action="table-double-click"
        weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@key" width="20em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- FEATURE TYPE DIALOG -->
  <xe:part id="edit-record-feature-types" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@key">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- FEATURE GROUP -->
  <xe:part id="table-list-feature-groups" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="feature_groups.feature_group" double-click-action="table-double-click"
        weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@key" width="20em" filterable="true"/>
          <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="sorting" label="${sorting}" source="@sorting" width="7em" align="right" filterable="false"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- FEATURE GROUP DIALOG -->
  <xe:part id="edit-record-feature-groups" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@key">
            <xe:validate not-empty="true" regex="[a-zA-Z_\-\.0-9]*:[a-zA-Z_\-\.0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
          <xe:include key="localized-label"/>
          <xe:editfield source="@sorting" label="${sorting}" label-style="label-default" width="10em" data-type="INTEGER" defaultvalue="1">
            <xe:validate not-empty="true"/>
          </xe:editfield>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- FEATURE VALUE REL -->
  <xe:part id="table-list-feature-value-rel-def" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="feature_value_rel_defs.feature_value_rel_def" double-click-action="table-double-click"
        weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="parent-feature" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="parent-feature" label="${parent-feature}" width="20em" filterable="true" formula="cachelookup('feature', '@key', @parent_feature)@name"/>
          <xe:column key="child-feature" label="${child-feature}" width="20em" filterable="true" formula="cachelookup('feature', '@key', @child_feature)@name"/>
          <xe:column key="child-rel-name" label="${name-child-relation}" source="@child_rel_name" width="20em" filterable="true"/>
          <xe:column key="parent-rel-name" label="${name-parent-relation}" source="@parent_rel_name" width="20em" filterable="true"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- FEATURE VALUE REL DIALOG -->
  <xe:part id="edit-record-feature-value-rel-def" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" label-width="20em" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:popupmenu label="${parent-feature}" label-style="label-default" label-width="20em" width="30em" source="@parent_feature" sort="ascending">
            <xe:options value-key="@key" label-key="@name">
              <xe:generator name="cachedtables" table-name="feature"/>
              <xe:filter condition="=@value_type=1 or @value_type=2"/> <!-- only hierachical features -->
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:popupmenu label="${child-feature}" label-style="label-default" label-width="20em" width="30em" source="@child_feature" sort="ascending">
            <xe:options value-key="@key" label-key="@name">
              <xe:generator name="cachedtables" table-name="feature"/>
               <xe:filter condition="=@value_type=1 or @value_type=2"/> <!-- only hierachical features -->
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:editfield label="${type}" label-style="label-default" label-width="20em" width="30em" source="@type" defaultvalue="link">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*"/>
          </xe:editfield>
          <xe:foreach-locale align="down">
            <xe:editfield label-style="label-default" label-width="20em" label="${name-child-relation} [%{locale}]" width="30em" source="@child_rel_name">
              <xe:validate not-empty="true"/>
            </xe:editfield>
          </xe:foreach-locale>
          <xe:foreach-locale align="down">
            <xe:editfield label-style="label-default" label-width="20em" label="${name-parent-relation} [%{locale}]" width="30em" source="@parent_rel_name">
              <xe:validate not-empty="true"/>
            </xe:editfield>
          </xe:foreach-locale>
          <xe:editfield label="${parent-sorting}" label-style="label-default" label-width="20em" width="10em" source="@parent_sort" data-type="INTEGER" defaultvalue="1">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:editfield label="${child-sorting}" label-style="label-default" label-width="20em" width="10em" source="@child_sort" data-type="INTEGER" defaultvalue="1">
            <xe:validate not-empty="true"/>
          </xe:editfield>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- FEATURE -->
  <xe:part id="table-list-features" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="features.feature" double-click-action="table-double-click" weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@key" width="30em" filterable="true" />
          <xe:column key="name" label="${name}" source="@name" width="25em" filterable="true" />
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="type" label="${type}" width="20em" filterable="true" formula="cachelookup('feature_type', '@key', @type)@name" />
          <xe:column key="sorting" label="${sorting}" source="@sorting" width="7em" align="right" filterable="false"/>
          <xe:column key="ui-control" label="${ui-control}" width="20em" filterable="true" formula="case(@ui_control, '0', '${default}', '1', '${checkbox}', '2', '${toggle}', '3', '${input}', '4', '${enumeration}', '5', '${rating}', '6', '${coordinates}', '7', '${color-dec}', '8', '${textarea}', '9', '${color-hex}', '10', '${radio-button}', '11', '${slider}', '12', '${asset-reference}', '13', '${asset-picker}', '(' + @ui_control + ')')"/>
          <xe:column key="value-type" label="${value-type}" width="20em" filterable="true" formula="case(@value_type, '0', '${none}', '1', '${hierarchical-value-list-string}', '2', '${value-list-string}', '3', '${integer-long}', '4', '${text-string}', '5', '${date-time}', '6', '${boolean}', '7', '${floating-point-number-double}', '8', '${integer-pair}', '9', '${date-time-pair}', '10', '${asset-reference}', '11', '${xml}', '12', '${floating-point-number-pair-double}', '13', '${date}', '14', '${date-pair}', '15', '${time}', '16', '${time-pair}', '17', '${year}', '18', '${year-pair}', '19', '${year-month}', '20', '${year-month-pair}', '21', '${month}', '22', '${month-pair}', '23', '${month-day}', '24', '${month-day-pair}', '25', '${day}', '26', '${day-pair}', '27', '${duration}', '28', '${asset-key}', '29', '${asset-key-ref}', '(' + @language_type + ')')"/>
          <xe:column key="language" label="${language}" width="10em" filterable="true" formula="case(@language_type, '0', '${none}', '1', '${optional}', '2', '${mandatory}', '(' + @language_type + ')')"/>
          <xe:column key="versioned" label="${storage}" width="10em" filterable="true" formula="case(@storage, '0', '${versioned}', '1', '${unversioned}', '2', '${attribute}', '3', '${full-text}', '4', '${function}', '(' + @storage + ')')"/>
          <xe:column key="is-asset-info" label="${asset-info}" formula="case(@isassetinfo, '0', '${not-shown-in-asset-info}', '1', '${show-in-general}', '2', '${show-in-more-information}')" filterable="true" width="25em"/>
          <xe:column key="multiple-values" label="${multiple-values}" source="@ismultivalue" width="10em" type="bool"/>
          <xe:column key="searchable" label="${searchable}" source="@issearchable" width="10em" type="bool"/>
          <xe:column key="rebuild-step" label="${rebuild-step}" width="10em" filterable="true" formula=":feature/xml_config/index-configs/index-config[1]/@rebuild-step"/>
          <xe:column key="trait" label="${trait-key}" source="@trait" width="20em" filterable="true"/>
          <xe:column key="trait_property" label="${property-key}" source="@trait_property" width="20em" filterable="true"/>
          <xe:column key="trait_property_top_level" label="${property-toplevel}" source="@trait_property_top_level" width="10em" type="bool"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(feature/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(feature/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="attribute_mapping" label="${attribute-mapping}" source="@attribute_mapping" width="30em" filterable="true" />
          <xe:column key="value_source" label="${master-data-value-list}" source="@value_source" width="20em" filterable="true" />
          <xe:column key="value_list_resource_key" label="Value list resource key" source="@value_list_resource_key" width="20em" filterable="true" />
          <xe:column key="custom" label="${custom}" width="10em" filterable="true" type="bool" formula=":count(feature/xml_config/index-configs/index-config[@is-custom])"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- FEATURE DIALOG -->
  <xe:part id="edit-record-features" transactional="true">
     <xe:inititems>
      <!--
          presets for the domain fields:
          you can only choose domains equal or lower than the users main-domains.
          the validation to suppress domains is done in a validation-listener.
      -->
      <!-- Slots are defined in the interface Slots -->
      <xe:inititem dest="@domain"  value="=$system.party@main_domain"  overwrite="false"/>
      <xe:inititem dest="@domain2" value="=$system.party@main_domain2" overwrite="false"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:editfield label="${id}" label-style="label-default" width="30em" source="@key" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:validate not-empty="true" regex="[a-zA-Z_\-\.0-9]*:[a-zA-Z_\-\.0-9]*"/>
          <xe:validate condition="=:empty(cs:cachelookup('feature')/feature[@key=$content/feature/@key and (not($content/feature/@rowid) or @rowid!=$content/feature/@rowid)])"/>
        </xe:editfield>
      </xe:group>
      <xe:separator/>
      <xe:expandgroup caption="${details}" id="details" expanded="true" save-state="true">
        <xe:group align="down">
          <xe:include key="localized-name-required-overwrite"/>
          <xe:include key="localized-description-overwrite"/>
          <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
            <xe:variable name="is_admin" value="=:system-property('censhare:is-admin-mode')='true'"/>
            <xe:variable name="is_feature_created" value="=countElements('feature_value')>0 or @rowid!=null"/>
            <xe:variable name="readonly" value="=:not($is_admin) and $is_feature_created"/>
            <xe:include key="localized-label"/>
            <xe:include key="localized-placeholder_text"/>
            <xe:include key="localized-tooltip"/>
            <xe:editfield label="${asset-resource-key}" label-style="label-default" width="30em" source="@asset_resource_key"/>
            <xe:editfield label="Namespace URI" label-style="label-default" width="30em" source="@namespace_uri"/>
            <xe:editfield label="${trait-key}" label-style="label-default" width="30em" source="@trait">
              <xe:validate not-empty="true"/>
              <xe:validate regex="[a-zA-Z_][a-zA-Z_:0-9]*"/>
            </xe:editfield>
            <xe:editfield label="${property-key}" label-style="label-default" width="30em" source="@trait_property">
              <xe:validate not-empty="true"/>
              <xe:validate regex="[a-zA-Z][a-zA-Z0-9]*"/>
            </xe:editfield>
            <xe:checkbox source="@trait_property_top_level" label="${property-toplevel}" checked-value="1" unchecked-value="0" label-style="label-default" defaultvalue="1"/>
            <xe:popupmenu source="@target_object_type" label="${target-object}" label-style="label-default" width="30em" defaultvalue="asset">
              <xe:options>
                <xe:option label="${asset}" value="asset"/>
                <xe:option label="${asset-relation}" value="asset_rel"/>
                <xe:option label="${asset-element-relation}" value="asset_element_rel"/>
                <xe:option label="${asset-element}" value="asset_element"/>
                <xe:option label="${asset-feature}" value="asset_feature"/>
                <xe:option label="${virtual}" value="_virtual"/>
              </xe:options>
              <xe:validate not-empty="true"/>
            </xe:popupmenu>
            <xe:include key="domains-required"/>
            <xe:popupmenu source="@type" label="${type}" label-style="label-default" width="30em" sort="ascending">
              <xe:options label-key="@name" value-key="@key">
                <xe:generator name="cachedtables" table-name="feature_type"/>
              </xe:options>
              <xe:validate not-empty="true"/>
            </xe:popupmenu>
            <xe:editfield source="@sorting" label="${sorting}" label-style="label-default" width="10em" data-type="INTEGER" defaultvalue="1">
              <xe:validate not-empty="true"/>
            </xe:editfield>

            <xe:selectcase value="=:$is_feature_created">
              <!--
                It checks if the feature was created or it is a new one.
                If it is new one - ${asset-key} will not be in the list of possible options to choose
              -->
              <xe:case value="false">
                <xe:popupmenu source="@value_type" label="${value-type}" label-style="label-default" width="30em"
                              readonly="=:$is_feature_created and system-property('censhare:is-admin-mode')='false'" sort="ascending">
                  <xe:options>
                    <xe:option label="${none}"                              value="0"/>
                    <xe:option label="${hierarchical-value-list-string}"    value="1"/>
                    <xe:option label="${value-list-string}"                 value="2"/>
                    <xe:option label="${integer-long}"                      value="3"/>
                    <xe:option label="${text-string}"                       value="4"/>
                    <xe:option label="${date-time}"                         value="5"/>
                    <xe:option label="${boolean}"                           value="6"/>
                    <xe:option label="${floating-point-number-double}"      value="7"/>
                    <xe:option label="${integer-pair}"                      value="8"/>
                    <xe:option label="${date-time-pair}"                    value="9"/>
                    <xe:option label="${asset-reference}"                   value="10"/>
                    <xe:option label="${xml}"                               value="11"/>
                    <xe:option label="${floating-point-number-pair-double}" value="12"/>
                    <xe:option label="${date}"                              value="13"/>
                    <xe:option label="${date-pair}"                         value="14"/>
                    <xe:option label="${time}"                              value="15"/>
                    <xe:option label="${time-pair}"                         value="16"/>
                    <xe:option label="${year}"                              value="17"/>
                    <xe:option label="${year-pair}"                         value="18"/>
                    <xe:option label="${year-month}"                        value="19"/>
                    <xe:option label="${year-month-pair}"                   value="20"/>
                    <xe:option label="${month}"                             value="21"/>
                    <xe:option label="${month-pair}"                        value="22"/>
                    <xe:option label="${month-day}"                         value="23"/>
                    <xe:option label="${month-day-pair}"                    value="24"/>
                    <xe:option label="${day}"                               value="25"/>
                    <xe:option label="${day-pair}"                          value="26"/>
                    <!--xe:option label="${duration}"                          value="27"/-->
                    <!--xe:option label="${asset-key}"                         value="28"/-->
                    <xe:option label="${asset-key-ref}"                     value="29"/>
                  </xe:options>
                  <xe:validate not-empty="true"/>
                  <xe:validate condition="= not(@value_type==28)"/>
                  <xe:change dest="@ui_control" value="=lookup(&apos;@value_type&apos;)@ui_control"/>
                </xe:popupmenu>
              </xe:case>
              <xe:case value="true">
                <xe:popupmenu source="@value_type" label="${value-type}" label-style="label-default" width="30em"
                              readonly="=:$is_feature_created and system-property('censhare:is-admin-mode')='false'" sort="ascending">
                  <xe:options>
                    <xe:option label="${none}"                              value="0"/>
                    <xe:option label="${hierarchical-value-list-string}"    value="1"/>
                    <xe:option label="${value-list-string}"                 value="2"/>
                    <xe:option label="${integer-long}"                      value="3"/>
                    <xe:option label="${text-string}"                       value="4"/>
                    <xe:option label="${date-time}"                         value="5"/>
                    <xe:option label="${boolean}"                           value="6"/>
                    <xe:option label="${floating-point-number-double}"      value="7"/>
                    <xe:option label="${integer-pair}"                      value="8"/>
                    <xe:option label="${date-time-pair}"                    value="9"/>
                    <xe:option label="${asset-reference}"                   value="10"/>
                    <xe:option label="${xml}"                               value="11"/>
                    <xe:option label="${floating-point-number-pair-double}" value="12"/>
                    <xe:option label="${date}"                              value="13"/>
                    <xe:option label="${date-pair}"                         value="14"/>
                    <xe:option label="${time}"                              value="15"/>
                    <xe:option label="${time-pair}"                         value="16"/>
                    <xe:option label="${year}"                              value="17"/>
                    <xe:option label="${year-pair}"                         value="18"/>
                    <xe:option label="${year-month}"                        value="19"/>
                    <xe:option label="${year-month-pair}"                   value="20"/>
                    <xe:option label="${month}"                             value="21"/>
                    <xe:option label="${month-pair}"                        value="22"/>
                    <xe:option label="${month-day}"                         value="23"/>
                    <xe:option label="${month-day-pair}"                    value="24"/>
                    <xe:option label="${day}"                               value="25"/>
                    <xe:option label="${day-pair}"                          value="26"/>
                    <!--xe:option label="${duration}"                          value="27"/-->
                    <xe:option label="${asset-key}"                         value="28"/>
                    <xe:option label="${asset-key-ref}"                     value="29"/>
                  </xe:options>
                  <xe:validate not-empty="true"/>
                  <xe:change dest="@ui_control" value="=lookup(&apos;@value_type&apos;)@ui_control"/>
                </xe:popupmenu>
              </xe:case>
            </xe:selectcase>

            <xe:selectcase source="@value_type">
              <!-- hierarchical value list (string) -->
              <xe:case value="1">
                <xe:popupmenu source="@ui_control" label="${ui-control}" label-style="label-default" width="30em"
                              readonly="=:$readonly" sort="ascending" defaultvalue="4">
                  <xe:options>
                    <xe:option label="${enumeration}"                       value="4"/>
                  </xe:options>
                </xe:popupmenu>
              </xe:case>
              <!-- value list (string) -->
              <xe:case value="2">
                <xe:popupmenu source="@ui_control" label="${ui-control}" label-style="label-default" width="30em"
                              readonly="=:$readonly" sort="ascending" defaultvalue="4">
                  <xe:options>
                    <xe:option label="${enumeration}"                       value="4"/>
                    <xe:option label="${radio-button}"                      value="10"/>
                  </xe:options>
                </xe:popupmenu>
              </xe:case>
              <!-- integer (long) -->
              <xe:case value="3">
                <xe:popupmenu source="@ui_control" label="${ui-control}" label-style="label-default" width="30em"
                              readonly="=:$readonly" sort="ascending" defaultvalue="3">
                  <xe:options>
                    <xe:option label="${input}"                             value="3"/>
                    <xe:option label="${color-dec}"                         value="7"/>
                    <xe:option label="${slider}"                            value="11"/>
                  </xe:options>
                </xe:popupmenu>
              </xe:case>
              <!-- text (string) -->
              <xe:case value="4">
                <xe:popupmenu source="@ui_control" label="${ui-control}" label-style="label-default" width="30em"
                              readonly="=:$readonly" sort="ascending" defaultvalue="3">
                  <xe:options>
                    <xe:option label="${input}"                             value="3"/>
                    <xe:option label="${textarea}"                          value="8"/>
                    <xe:option label="${color-hex}"                         value="9"/>
                  </xe:options>
                </xe:popupmenu>
              </xe:case>
              <!-- boolean -->
              <xe:case value="6">
                <xe:popupmenu source="@ui_control" label="${ui-control}" label-style="label-default" width="30em"
                              readonly="=:$readonly" sort="ascending" defaultvalue="1">
                  <xe:options>
                    <xe:option label="${checkbox}"                          value="1"/>
                    <xe:option label="${toggle}"                            value="2"/>
                  </xe:options>
                </xe:popupmenu>
              </xe:case>
              <!-- floating point number (double) -->
              <xe:case value="7">
                <xe:popupmenu source="@ui_control" label="${ui-control}" label-style="label-default" width="30em"
                              readonly="=:$readonly" sort="ascending" defaultvalue="3">
                  <xe:options>
                    <xe:option label="${input}"                             value="3"/>
                    <xe:option label="${rating}"                            value="5"/>
                    <xe:option label="${slider}"                            value="11"/>
                  </xe:options>
                </xe:popupmenu>
              </xe:case>
              <!-- integer pair -->
              <xe:case value="8">
                <xe:popupmenu source="@ui_control" label="${ui-control}" label-style="label-default" width="30em"
                              readonly="=:$readonly" sort="ascending" defaultvalue="3">
                  <xe:options>
                    <xe:option label="${input}"                             value="3"/>
                  </xe:options>
                </xe:popupmenu>
              </xe:case>
              <xe:case value="10">
                <xe:popupmenu source="@ui_control" label="${ui-control}" label-style="label-default" width="30em"
                              readonly="=:$readonly" sort="ascending" defaultvalue="12">
                  <xe:options>
                    <xe:option label="${asset-reference}"                   value="12"/>
                    <xe:option label="${asset-picker}"                      value="13"/>
                  </xe:options>
                </xe:popupmenu>
              </xe:case>
              <!-- xml -->
              <xe:case value="11">
                <xe:popupmenu source="@ui_control" label="${ui-control}" label-style="label-default" width="30em"
                              readonly="=:$readonly" sort="ascending" defaultvalue="8">
                  <xe:options>
                    <xe:option label="${textarea}"                          value="8"/>
                  </xe:options>
                </xe:popupmenu>
              </xe:case>
              <!-- floating point number pair (double) -->
              <xe:case value="12">
                <xe:popupmenu source="@ui_control" label="${ui-control}" label-style="label-default" width="30em"
                              readonly="=:$readonly" sort="ascending" defaultvalue="3">
                  <xe:options>
                    <xe:option label="${input}"                             value="3"/>
                  </xe:options>
                </xe:popupmenu>
              </xe:case>
              <xe:case value="29">
                <xe:popupmenu source="@ui_control" label="${ui-control}" label-style="label-default" width="30em"
                              readonly="=:$readonly" sort="ascending" defaultvalue="12">
                  <xe:options>
                    <xe:option label="${asset-reference}"                   value="12"/>
                    <xe:option label="${asset-picker}"                      value="13"/>
                  </xe:options>
                </xe:popupmenu>
              </xe:case>
              <xe:defaultcase>
                <xe:popupmenu source="@ui_control" label="${ui-control}" label-style="label-default" width="30em"
                              readonly="=:$readonly" sort="ascending" defaultvalue="0">
                  <xe:options>
                    <xe:option label="${default}"                   value="0"/>
                  </xe:options>
                </xe:popupmenu>
              </xe:defaultcase>
            </xe:selectcase>

            <xe:group align="right" visible="=@value_type==3 or @value_type==7 or @value_type==8 or @value_type==12" readonly="=@unit_set!=null and @unit==null">
              <xe:listen-to source="@value_type"/>
              <xe:listen-to source="@unit_set"/>
              <xe:popupmenu source="@unit" label="${unit}" label-style="label-default" weight-x="1" sort="ascending" width="30em">
                <xe:options label-key="@name" value-key="@key">
                  <xe:generator name="cachedtables" table-name="unit"/>
                </xe:options>
              </xe:popupmenu>
              <xe:deletebutton source="@unit"/>
            </xe:group>
            <xe:group align="right" visible="=@value_type==3 or @value_type==7 or @value_type==8 or @value_type==12" readonly="=@unit!=null">
              <xe:listen-to source="@value_type"/>
              <xe:listen-to source="@unit"/>
              <xe:popupmenu source="@unit_set" label="${unit-set}" label-style="label-default" weight-x="1" sort="ascending" width="30em">
                <xe:options label-key="@name" value-key="@key">
                  <xe:generator name="cachedtables" table-name="unit_set"/>
                </xe:options>
              </xe:popupmenu>
              <xe:deletebutton source="@unit_set"/>
            </xe:group>
            <xe:popupmenu source="@language_type" label="${language}" label-style="label-default" width="30em" defaultvalue="0">
              <xe:options>
                <xe:option label="${none}" value="0"/>
                <xe:option label="${optional}" value="1"/>
                <xe:option label="${mandatory}" value="2"/>
              </xe:options>
              <xe:validate not-empty="true"/>
            </xe:popupmenu>
            <xe:popupmenu source="@color_type" label="${colour}" label-style="label-default" width="30em" defaultvalue="0">
              <xe:options>
                <xe:option label="${none}" value="0"/>
                <xe:option label="${optional}" value="1"/>
                <xe:option label="${mandatory}" value="2"/>
              </xe:options>
              <xe:validate not-empty="true"/>
            </xe:popupmenu>
            <xe:popupmenu source="@storage" label="${storage}" readonly="=:$is_feature_created and system-property('censhare:is-admin-mode')='false'" label-style="label-default" width="30em" defaultvalue="0">
              <xe:options>
                <xe:option label="${versioned}" value="0"/>
                <xe:option label="${unversioned}" value="1"/>
                <xe:option label="${attribute}" value="2"/>
                <xe:option label="${full-text}" value="3"/>
                <xe:option label="${function}" value="4"/>
                <xe:option label="${out-of-band}" value="5"/>
                <xe:option label="${external}" value="6"/>
              </xe:options>
              <xe:validate not-empty="true"/>
            </xe:popupmenu>
            <xe:edittext label="${attribute-mapping}" label-style="label-default" width="30em" source="@attribute_mapping">
              <xe:listen-to source="@storage"/>
              <xe:visible-filters>
                <xe:filter condition="=@storage==2 or @storage==4"/>
              </xe:visible-filters>
              <xe:validate not-empty="=@storage==2"/>
            </xe:edittext>
            <xe:edittext label="${value-expression}" label-style="label-default" width="30em" scrollpane="false" rows="1" source="@value_expression"/>
            <xe:editfield label="${master-data-value-list}" label-style="label-default" width="30em" source="@value_source">
              <xe:listen-to source="@storage"/>
              <xe:listen-to source="@value_type"/>
              <xe:visible-filters>
                <xe:filter condition="=(@storage==0 or @storage==1 or @storage==2 or @storage==4) and (@value_type==1 or @value_type==2)"/>
              </xe:visible-filters>
            </xe:editfield>
            <xe:editfield label="${value-list-resource-key}" label-style="label-default" width="30em" source="@value_list_resource_key">
              <xe:listen-to source="@value_type"/>
              <xe:visible-filters>
                <xe:filter condition="=(@value_type==3 or @value_type==4 or @value_type==10 or @value_type==29 or @value_type==1)"/>
              </xe:visible-filters>
            </xe:editfield>
            <xe:checkbox source="@is_xml_attr" label="XML-Attribut" checked-value="1" unchecked-value="0" label-style="label-default"/>
            <xe:checkbox source="@ismultivalue" label="${multiple-values}" checked-value="1" unchecked-value="0" label-style="label-default"/>
            <xe:checkbox source="@issearchable" label="${searchable}" defaultvalue="1" checked-value="1" unchecked-value="0" label-style="label-default"/>
            <xe:checkbox source="@has_relevance" label="${relevance}" defaultvalue="0" checked-value="1" unchecked-value="0" label-style="label-default"/>
            <xe:checkbox source="@user_modifiable" label="${modifiable-by-user}" defaultvalue="1" checked-value="1" unchecked-value="0" label-style="label-default"/>
          </xe:group>
        </xe:group>
      </xe:expandgroup>
      <!-- Classification system -->
      <xe:separator/>
      <xe:expandgroup caption="${classification-system}" align="down" expanded="true">
        <xe:popupmenu label="${system}" label-style="label-default" width="30em" source="@classification_system">
          <xe:options>
            <xe:option label="CPV (Common Procurement Vocabulary)" value="CPV"/>
            <xe:option label="eCl@ss" value="ECLASS"/>
            <xe:option label="eOTD (ECCMA Open Technical Dictionary)" value="EOTD"/>
            <xe:option label="ETIM (European Technical Information Model)" value="ETIM"/>
            <xe:option label="GPC (Global Product Classification)" value="GPC"/>
            <xe:option label="profiCl@ss" value="PROFICLASS"/>
            <xe:option label="RNTD (RosettaNet Technical Dictionary)" value="RNTD"/>
            <xe:option label="RUS (Requisite Unifying Structure)" value="RUS"/>
            <xe:option label="UNSPSC  (United Nations Standard Products and Services Code)" value="UNSPSC"/>
          </xe:options>
        </xe:popupmenu>
        <xe:editfield label="${version}" label-style="label-default" width="30em" source="@classification_system_version"/>
        <xe:editfield label="${key}" label-style="label-default" width="30em" source="@classification_system_key"/>
        <xe:editfield label="${unit-key}" label-style="label-default" width="30em" source="@classification_system_unit_key" visible="=:not(feature/@classification_system=('CPV', 'GPC', 'UNSPSC'))">
          <xe:listen-to source="@classification_system"/>
        </xe:editfield>
      </xe:expandgroup>
      <!-- Asset reference -->
      <xe:group align="down" visible="=(@value_type==10 or @value_type==29)" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:listen-to source="@value_type">
          <xe:change dest="@parent_name" value=""/>
          <xe:change dest="@child_name" value=""/>
        </xe:listen-to>
        <xe:separator/>
        <xe:expandgroup caption="${asset-reference}" align="down" expanded="true">
          <xe:foreach-locale>
            <xe:group align="down">
              <xe:edittext label-style="label-default" label="${parent-title} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@parent_name"/>
              <xe:edittext label-style="label-default" label="${child-title} [%{locale}]" width="30em" scrollpane="false" rows="1" source="@child_name"/>
            </xe:group>
          </xe:foreach-locale>
          <xe:group align="right">
            <xe:label label="${filters}" label-style="label-default" align-y="top"/>
            <xe:group align="down">
              <xe:foreach source="match_criteria.entry">
                <xe:group align="down">
                  <xe:checkbox caption="${prioritized}" checked-value="1" unchecked-value="0" defaultvalue="0" source="@priority"/>
                  <xe:group align="right">
                    <xe:group align="down">
                      <xe:label value="${parent-asset}"/>
                      <xe:group align="right">
                        <xe:edit-query width="30em" height="60" dialog-type="dialog-asset-filter" source="parent-query" expression-id="edit-query"/>
                        <xe:deletebutton source="parent-query" align-y="top"/>
                      </xe:group>
                    </xe:group>
                    <xe:group align="down">
                      <xe:label value="${child-asset}"/>
                      <xe:group align="right">
                        <xe:edit-query width="30em" height="60" dialog-type="dialog-asset-filter" source="child-query" expression-id="edit-query"/>
                        <xe:deletebutton source="child-query" align-y="top"/>
                      </xe:group>
                    </xe:group>
                  </xe:group>
                  <xe:deletebutton/>
                  <xe:separator/>
                </xe:group>
              </xe:foreach>
            </xe:group>
          </xe:group>
        </xe:expandgroup>
      </xe:group>
      <!-- View -->
      <xe:group align="down" visible="=@type='censhare:asset-feature'" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:separator/>
        <xe:expandgroup caption="${view}" align="down" expanded="true">
          <xe:listen-to source="@type">
            <xe:change dest="@isassetinfo" value="0"/>
          </xe:listen-to>
          <xe:popupmenu source="@isassetinfo" label="${asset-info}" label-style="label-default" width="30em" defaultvalue="0">
            <xe:options>
              <xe:option label="${not-shown-in-asset-info}" value="0"/>
              <xe:option label="${show-in-general}" value="1"/>
              <xe:option label="${show-in-more-information}" value="2"/>
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:editfield source="@assetinfo_sorting" label="${sorting}" label-style="label-default" width="10em" data-type="INTEGER" defaultvalue="1">
            <xe:validate not-empty="true"/>
          </xe:editfield>
        </xe:expandgroup>
      </xe:group>
      <!-- Values (for list and hierarchical values only) -->
      <xe:group align="down" visible="=@value_type=1 or @value_type=2" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'"> <!-- defined above -->
        <!-- rh rechanged: listen-to works only in a proper place -->
        <xe:listen-to source="@value_type"/> <!-- value_type changed -> table may be shown -->
        <xe:separator/>
        <xe:expandgroup caption="${values}" id="values" expanded="true" save-state="true">
          <xe:group style="group-indent-left-right" align="down">
            <xe:group align="down">
              <xe:group align="right">
                <xe:button action="new-feature-value"     icon="add"       tooltip="${new}"/>
                <xe:button action="edit-feature-value"    icon="edit"      tooltip="${edit}"/>
                <xe:button action="delete-feature-value"  icon="delete"    tooltip="${delete}"/>
                <xe:button action="copy-feature-value"    icon="duplicate" tooltip="${duplicate}"/>
                <xe:button action="export-internal-table" icon="export"    tooltip="${export}"/>
              </xe:group>
              <xe:filterwidget id="table-filter" filter-directly="true"/>
              <xe:xe-table id="table" filter-widget="table-filter" source="feature_value" prefwidth="100" weight-x="1" height="350" double-click-action="table-double-click" ordercol="@value_key">
                <xe:columns>
                  <xe:sorting>
                    <xe:sort-col key="name" ascending="true"/>
                  </xe:sorting>
                  <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
                  <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
                  <xe:column key="value" label="${value}" source="@value_key" width="30em" filterable="true" />
                  <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
                  <xe:column key="colour" label="${colour}" type="color" source="@color" width="6em"/>
                  <xe:column key="sorting" label="${sorting}" source="@sorting" width="7em" filterable="true" align="right"/>
                  <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
                  <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
                </xe:columns>
                <xe:dnd>
                  <xe:drag mode="multi"/>
                  <xe:drop mode="none"/>
                </xe:dnd>
              </xe:xe-table>
            </xe:group>
          </xe:group>
        </xe:expandgroup>
      </xe:group>

      <!-- Child features -->
      <xe:separator/>
      <xe:expandgroup caption="${child-features}" id="child-features" expanded="true" save-state="true" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:group align="down">
          <!--
            List of features, which represents a column in database structure.
            All features can be extracted from db-schema.xml in the "feature" attribute of "column" xml-nodes
          -->
          <xe:variable name="excluded_features" value="'censhare:asset.id',
            'censhare:asset.currversion',
            'censhare:asset.id_extern',
            'censhare:asset.name',
            'censhare:asset.type',
            'censhare:asset.application',
            'censhare:asset.state',
            'censhare:asset.deletion',
            'censhare:asset.checked_out_by',
            'censhare:asset.modified_by',
            'censhare:asset.wf_target',
            'censhare:asset.wf_id',
            'censhare:asset.wf_step',
            'censhare:asset.wf_worst_state_id',
            'censhare:asset.domain',
            'censhare:asset.domain2',
            'censhare:asset.modified_date',
            'censhare:asset.checked_out_date',
            'censhare:asset.non_owner_access',
            'censhare:asset.iscancellation',
            'censhare:asset.storage_state',
            'censhare:asset.author',
            'censhare:asset.annotation',
            'censhare:asset.description',
            'censhare:asset.keywords',
            'censhare:asset.language',
            'censhare:asset.color',
            'censhare:asset.deadline',
            'censhare:asset.deadline_calc',
            'censhare:asset.deadline_actual',
            'censhare:asset.issue_no',
            'censhare:asset.issue_year',
            'censhare:asset.issue_name',
            'censhare:asset.checked_out_inside_id',
            'censhare:asset.created_by',
            'censhare:asset.creation_date',
            'censhare:asset.priority',
            'censhare:asset.first_actual_paging',
            'censhare:asset.first_target_paging',
            'censhare:asset.first_paging',
            'censhare:asset_element.domain',
            'censhare:asset_element.domain2',b
            'censhare:asset_element.asset_format',
            'censhare:storage_item.key',
            'censhare:storage_item.mimetype',
            'censhare:storage_item.app_version',
            'censhare:storage_item.hashcode',
            'censhare:storage_item.original_path',
            'censhare:storage_item.original_name',
            'censhare:storage_item.colordepthbits',
            'censhare:storage_item.dpi'"/>
          <xe:foreach source="feature_rel" align="down" row-align="right" not-empty="true">
            <xe:popupmenu label="${feature}" label-style="label-default" weight-x="1" source="@child_feature" sort="ascending">
              <xe:options label-key="@name" value-key="@key">
                <xe:generator name="cachedtables" table-name="feature"/>
                <xe:filter condition="=:not(contains($excluded_features, feature/@key))"/>
              </xe:options>
              <xe:validate not-empty="true"/>
            </xe:popupmenu>
            <xe:popupmenu label="${type}" width="10em" source="@type" defaultvalue="hierarchy">
              <xe:options>
                <xe:option label="${hierarchy}" value="hierarchy"/>
                <xe:option label="${context}" value="context"/>
              </xe:options>
              <xe:validate not-empty="true"/>
            </xe:popupmenu>
            <xe:deletebutton/>
            <xe:checkbox caption="${enabled}" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
              <xe:validate not-null="true"/>
            </xe:checkbox>
          </xe:foreach>
        </xe:group>
      </xe:expandgroup>

      <!-- Index configuration(s) -->
      <xe:separator/>
      <xe:expandgroup caption="${index-config}" align="down" id="server-configs" expanded="true" save-state="true" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:group align="down">
          <xe:foreach source="xml_config.index-configs.index-config">
            <xe:inititems>
              <xe:inititem dest="@is-custom" value="true"/>
            </xe:inititems>
            <xe:variable name="isCenshare" value="=:not(index-config/@is-custom) and not (index-config/@server_name)"/>
            <xe:variable name="hasConflicts" value="=:not(not(index-config/patch-conflicts))"/>
            <!-- another way to check if a node exists and put that in a boolean?... -->
            <xe:variable name="readonly" value="=:$isCenshare and not($hasConflicts)"/>
            <xe:groupbox align="down" caption="=:concat(if($isCenshare) then 'censhare default configuration' else 'Custom configuration', if ($hasConflicts) then '            !!!!!!!!!!!! THIS CONFIG HAS CONFLICTS !!!!!!!!!!!!            ' else '')">
              <xe:selectcase value="=:$isCenshare">
                <xe:case value="false">
                  <xe:popupmenu label="${server-name}" source="@server_name" label-style="label-default" width="30em">
                    <xe:options null-entry="true" label-key="@description" value-key="@name">
                      <xe:generator name="cachedtables" table-name="server_def"/>
                    </xe:options>
                  </xe:popupmenu>
                </xe:case>
              </xe:selectcase>
              <xe:checkbox label-style="label-default" label="${disabled}" source="@disabled" checked-value="true" unchecked-value="false" readonly="=:$readonly"/>
              <xe:editfield source="@rebuild-step" label="${rebuild-step}" label-style="label-default" width="10em" data-type="INTEGER" readonly="=:$readonly"/>
              <xe:popupmenu label="${type}" label-style="label-default" width="30em" source="@type" readonly="=:$readonly">
                <xe:options>
                  <xe:option label="${default}" value="direct-value"/>
                  <xe:option label="${hierarchical}" value="hierarchical"/>
                  <xe:option label="${pair}" value="pair"/>
                  <xe:option label="${coordinates}" value="coordinates"/>
                  <xe:option label="${range}" value="range"/>
                  <xe:option label="${numeric-trie}" value="numeric-trie"/>
                  <xe:option label="${fulltext}" value="fulltext"/>
                  <xe:option label="${virtual-fulltext}" value="virtual-fulltext"/>
                </xe:options>
              </xe:popupmenu>
              <xe:checkbox label-style="label-default" label="${isnull}" source="@isnull-column" checked-value="true" unchecked-value="false" readonly="=:$readonly"/>
              <xe:checkbox label-style="label-default" label="${notnull}" source="@notnull-column" checked-value="true" unchecked-value="false" readonly="=:$readonly"/>
              <xe:checkbox label-style="label-default" label="${collator}" source="@collator-columns" checked-value="true" unchecked-value="false" readonly="=:$readonly"/>
              <xe:checkbox label-style="label-default" label="${sort-value}" source="@sort-value" checked-value="true" unchecked-value="false" readonly="=:$readonly"/>
              <xe:popupmenu label="${hierarchical-feature-mode}" label-style="label-default" width="30em" source="@hierarchical-feature-mode" readonly="=:$readonly">
                <xe:options>
                  <xe:option label="${store-flat}" value="store-flat"/>
                  <xe:option label="${store-hierarchical}" value="store-hierarchical"/>
                  <xe:option label="${store-flat-and-hierarchical}" value="store-flat-and-hierarchical"/>
                </xe:options>
              </xe:popupmenu>
              <xe:popupmenu label="${relevance-mode}" label-style="label-default" width="30em" source="@relevance-mode" readonly="=:$readonly">
                <xe:options>
                  <xe:option label="BM25" value="BM25"/>
                  <xe:option label="BM25Flat" value="BM25FLAT"/>
                  <xe:option label="Cosine" value="COSINE"/>
                  <xe:option label="Count" value="COUNT"/>
                  <xe:option label="Direct" value="DIRECT"/>
                </xe:options>
              </xe:popupmenu>
              <xe:editfield label="${sort-by}" source="@sort-by" label-style="label-default" width="30em" data-type="VARCHAR" readonly="=:$readonly"/>
              <xe:selectcase source="@type">
                <xe:case value="fulltext">
                  <xe:groupbox caption="${fulltext}" align="down" style="group-indent-left-right">
                    <xe:strut width="60em"/>
                    <xe:checkbox label="${default-text-index}" label-style="label-default" source="@default-fulltext-index" readonly="=:$readonly" tooltip="${default_fulltext_tooltip}"/>
                    <xe:group align="right" tooltip="${content_fulltext_tooltip}">
                      <xe:checkbox label="${content-text-index}" label-style="label-default" source="@isContentFulltext" readonly="=:$readonly"/>
                      <xe:selectcase source="@isContentFulltext">
                        <xe:case value="true">
                          <xe:group align="down">
                            <xe:editfield label="${max-fulltext-filesize}" label-style="label-default" width="10em" source="@max-file-size" data-type="INTEGER" readonly="=:$readonly"/>
                            <xe:editfield label="${content-filter-xpath}" label-style="label-default" width="30em" source="@content-filter-xpath" readonly="=:$readonly"/>
                          </xe:group>
                        </xe:case>
                      </xe:selectcase>
                    </xe:group>
                    <xe:editfield label="${min-length}" label-style="label-default" width="30em" source="fulltext@min-length" readonly="=:$readonly"/>
                    <xe:checkbox label="${use-stopwords}" label-style="label-default" source="fulltext@stopword-list" checked-value="default" unchecked-value="false" readonly="=:$readonly"/>
                    <xe:checkbox label="${use-stemming}" label-style="label-default" source="fulltext@stemming" checked-value="true" unchecked-value="false" defaultvalue="false" readonly="=:$readonly"/>
                    <xe:checkbox label="${use-frequency}" label-style="label-default" source="fulltext@use-frequency" checked-value="true" unchecked-value="false" readonly="=:$readonly" defaultvalue="true"/>
                    <xe:checkbox label="${strip-diacritics}" label-style="label-default" source="fulltext@strip-diacritics" checked-value="true" unchecked-value="false" defaultvalue="false" readonly="=:$readonly"/>
                    <xe:popupmenu label="${junction-expand-operator}" label-style="label-default" source="fulltext@expand-junction-operator" defaultvalue="AND_NOT_EMPTY">
                      <xe:options>
                        <xe:option label="${junction-operator-and-not-empty}" value="AND_NOT_EMPTY"/>
                        <xe:option label="${junction-operator-and}" value="AND"/>
                      </xe:options>
                    </xe:popupmenu>
                    <xe:groupbox caption="${fuzzy-search-settings}" align="down" style="group-indent-left-right">
                      <xe:strut width="60em"/>
                      <xe:editfield label="${fuzzy-min-length}" label-style="label-default" tooltip="${fuzzy-min-length}" width="30em" source="fulltext@fuzzy-min-length" readonly="=:$readonly"/>
                      <xe:editfield label="${fuzzy-max-distance}" label-style="label-default" tooltip="${fuzzy-max-distance}" width="30em" source="fulltext@fuzzy-max-distance" readonly="=:$readonly"/>
                      <xe:editfield label="${max-bitap-errors}" label-style="label-default" tooltip="${max-bitap-errors}" width="30em" source="fulltext@max-bitap-errors" readonly="=:$readonly"/>
                      <xe:editfield label="${fuzzy-ngram-length}" label-style="label-default" tooltip="${fuzzy-ngram-length}" width="30em" source="fulltext@fuzzy-ngram-length" readonly="=:$readonly">
                        <xe:validate min-value="1" max-value="4"/>
                      </xe:editfield>
                      <xe:editfield label="${prefix-expansion-limit}" label-style="label-default" tooltip="${prefix-expansion-limit}" width="30em" source="fulltext@prefix-expansion-limit" readonly="=:$readonly"/>
                      <xe:editfield label="${infix-expansion-limit}" label-style="label-default" tooltip="${infix-expansion-limit}" width="30em" source="fulltext@infix-expansion-limit" readonly="=:$readonly"/>
                      <xe:editfield label="${fuzzy-expansion-limit}" label-style="label-default" tooltip="${fuzzy-expansion-limit}" width="30em" source="fulltext@fuzzy-expansion-limit" readonly="=:$readonly"/>
                      <xe:editfield label="${fuzzy-skip-results}" label-style="label-default" tooltip="${fuzzy-skip-results}" width="30em" source="fulltext@fuzzy-skip-results" readonly="=:$readonly"/>
                      <xe:editfield label="${fuzzy-end-results}" label-style="label-default" tooltip="${fuzzy-end-results}" width="30em" source="fulltext@fuzzy-end-resuts" readonly="=:$readonly"/>
                      <xe:editfield label="${fuzzy-min-alpha}" label-style="label-default" tooltip="${fuzzy-min-alpha}" width="30em" source="fulltext@fuzzy-min-alpha" readonly="=:$readonly"/>
                      <xe:editfield label="${fulltext-scale}" label-style="label-default" tooltip="${fulltext-scale}" width="30em" source="fulltext@scale" readonly="=:$readonly" data-type="NUMBER(8,3)"/>
                    </xe:groupbox>
                    <xe:groupbox caption="${features}" align="down" style="group-indent-left-right" visible="=not(@isContentFulltext='true') or count(fulltext/feature) &gt; 0">
                      <xe:strut width="60em"/>
                      <xe:foreach source="fulltext.feature" row-align="down" new-button="=:not($readonly)">
                        <xe:group align="right">
                          <xe:popupmenu label="${name}" label-style="label-default" width="30em" source="@key" sort="ascending" readonly="=:$readonly">
                            <xe:options label-key="@name" value-key="@key">
                              <xe:generator expression="=: for $x in cs:cachelookup('feature')/feature return if ($x/@storage != 3) then $x else ()"/>
                            </xe:options>
                          </xe:popupmenu>
                          <xe:strut width="1em"/>
                          <xe:popupmenu label="${mode}" width="10em" source="@mode" readonly="=:$readonly">
                            <xe:options>
                              <xe:option label="${content}" value="content"/>
                              <xe:option label="${key}" value="lookup"/>
                              <xe:option label="${reference}" value="reference"/>
                            </xe:options>
                          </xe:popupmenu>
                          <xe:selectcase value="=:$readonly">
                            <xe:case value="false">
                              <xe:deletebutton/>
                            </xe:case>
                          </xe:selectcase>
                        </xe:group>
                      </xe:foreach>
                    </xe:groupbox>
                    <xe:groupbox caption="${character-mappings}" align="down" style="group-indent-left-right">
                      <xe:strut width="60em"/>
                      <xe:foreach source="fulltext.character-mapping.mapping" row-align="down" new-button="=:not($readonly)">
                        <xe:group align="right">
                          <xe:editfield label="${source}" label-style="label-default" width="5em" source="@source" readonly="=:$readonly"/>
                          <xe:strut width="1em"/>
                          <xe:editfield label="${target}" label-style="label-default" width="5em" source="@target" readonly="=:$readonly"/>
                          <xe:selectcase value="=:$readonly">
                            <xe:case value="false">
                              <xe:deletebutton/>
                            </xe:case>
                          </xe:selectcase>
                        </xe:group>
                      </xe:foreach>
                    </xe:groupbox>
                  </xe:groupbox>
                </xe:case>
                <xe:case value="virtual-fulltext">
                  <xe:groupbox caption="${virtual-fulltext}" align="down" style="group-indent-left-right">
                    <xe:listen-to source="@type"/>
                    <xe:visible-filters>
                      <xe:filter condition="=@type=='virtual-fulltext'"/>
                    </xe:visible-filters>
                    <xe:strut width="60em"/>
                    <xe:foreach source="fulltext.feature" row-align="down" new-button="=:not($readonly)">
                      <xe:group align="right">
                        <xe:popupmenu label="${name}" label-style="label-default" width="30em" source="@key" sort="ascending" readonly="=:$readonly">
                          <xe:options label-key="@name" value-key="@key">
                            <xe:generator name="cachedtables" table-name="feature" source="@storage" match="3"/>
                          </xe:options>
                        </xe:popupmenu>
                        <xe:strut width="1em"/>
                        <xe:popupmenu label="${mode}" width="10em" source="@mode" defaultvalue="fulltext" readonly="=:$readonly">
                          <xe:options>
                            <xe:option label="${fulltext}" value="fulltext"/>
                          </xe:options>
                        </xe:popupmenu>
                        <xe:strut width="1em"/>
                        <xe:editfield label="${fulltext-scale}" tooltip="${fulltext-scale}" width="10em" source="@scale" readonly="=:$readonly" data-type="NUMBER(8,3)"/>
                        <xe:strut width="1em"/>
                        <xe:selectcase value="=:$readonly">
                          <xe:case value="false">
                            <xe:deletebutton/>
                          </xe:case>
                        </xe:selectcase>
                      </xe:group>
                    </xe:foreach>
                    <xe:popupmenu label="${junction-expand-operator}" label-style="label-default" source="fulltext@expand-junction-operator" defaultvalue="AND_NOT_EMPTY">
                      <xe:options>
                        <xe:option label="${junction-operator-and-not-empty}" value="AND_NOT_EMPTY"/>
                        <xe:option label="${junction-operator-and}" value="AND"/>
                      </xe:options>
                    </xe:popupmenu>
                  </xe:groupbox>
                </xe:case>
                <xe:case value="numeric-trie">
                  <xe:group>
                    <xe:listen-to source="@type"/>
                    <xe:visible-filters>
                      <xe:filter condition="=@type=='numeric-trie' or @type=='range'"/>
                    </xe:visible-filters>
                    <xe:editfield label="${numeric-trie-bits}" label-style="label-default" width="10em" source="@numeric-trie-bits" readonly="=:$readonly"/>
                  </xe:group>
                </xe:case>
                <xe:case value="range">
                  <xe:group>
                    <xe:listen-to source="@type"/>
                    <xe:visible-filters>
                      <xe:filter condition="=@type=='numeric-trie' or @type=='range'"/>
                    </xe:visible-filters>
                    <xe:editfield label="${numeric-trie-bits}" label-style="label-default" width="10em" source="@numeric-trie-bits" readonly="=:$readonly">
                      <xe:validate not-empty="true"/>
                    </xe:editfield>
                  </xe:group>
                </xe:case>
              </xe:selectcase>
              <xe:groupbox caption="${hints}" align="down" id="server-configs">
                <xe:strut width="60em"/>
                <xe:foreach source="hint.property" row-align="down" new-button="=:not($readonly)">
                  <xe:group align="right">
                    <xe:editfield label="${name}" label-style="label-default" width="30em" source="@name" readonly="=:$readonly"/>
                    <xe:editfield label="${value}" label-style="label-default" label-width="10em" width="30em" source="@value" readonly="=:$readonly"/>
                    <xe:selectcase value="=:$readonly">
                      <xe:case value="false">
                        <xe:deletebutton/>
                      </xe:case>
                    </xe:selectcase>
                  </xe:group>
                </xe:foreach>
              </xe:groupbox>
              <xe:selectcase value="=:$hasConflicts">
                <xe:case value="true">
                  <xe:groupbox caption="Conflicts that occured during a patch on this configuration" align="down">
                    <xe:strut width="60em"/>
                    <xe:label label="" value="Review the following conflicts, compare with the 'censhare default configuration' if possible and make necessary changes."/>
                    <xe:label label="" value="Then click on the checkbox 'conflicts resolved', click OK and restart the server."/>
                    <xe:label label="" value=" "/>
                    <xe:foreach source="patch-conflicts.patch-conflict" row-align="down" new-button="false">
                      <xe:label label="Patch ID:" source="@patchID" label-style="label-default"/>
                      <xe:label label="error:" source="exception" label-style="label-default"/>
                      <xe:displayxml label="Patch command" value="=:patch-conflict/patch" label-style="label-default" format="false" prefwidth="60em" prefheight="100"/>
                    </xe:foreach>
                    <xe:checkbox caption="Mark the conflicts as resolved" defaultvalue="false" source="patch-conflicts@conflicts-resolved"/>
                  </xe:groupbox>
                </xe:case>
              </xe:selectcase>
              <xe:deletebutton visible="=:not($isCenshare)"/>
            </xe:groupbox>
          </xe:foreach>
        </xe:group>
      </xe:expandgroup>

    </xe:group>
  </xe:part>

  <!-- FEATURE VALUE DIALOG -->
  <xe:part id="edit-record-feature-value" transactional="true">
    <xe:inititems>
      <!--
          presets for the domain fields:
          you can only choose domains equal or lower than the users main-domains.
          the validation to suppress domains is done in a validation-listener.
      -->
      <!-- Slots are defined in the interface Slots -->
      <xe:inititem dest="@domain"  value="=$system.party@main_domain"  overwrite="false"/>
      <xe:inititem dest="@domain2" value="=$system.party@main_domain2" overwrite="false"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:group align="down" enabled="=@is_hierarchical='0'">
            <!-- do not show for hierachical features -->
            <xe:editfield source="@value_key" label-style="label-default" label="${value}" width="30em">
              <xe:validate regex="[a-zA-Z_:\-0-9]+" not-empty="true"/>
            </xe:editfield>
          </xe:group>
          <xe:group align="down" enabled="=@is_hierarchical='1'">
            <!-- do not show for others then hierarchical feature-types -->
            <xe:editfield source="@parent_key" label-style="label-default" label="${parent-value}" width="30em" readonly="true"/>
            <xe:editfield source="@shortname" label-style="label-default" label="${value}" width="30em">
              <xe:validate regex="[a-zA-Z_:\-0-9]+" not-empty="true"/>
            </xe:editfield>
          </xe:group>
          <xe:include key="localized-name-required-overwrite"/>
          <xe:include key="localized-description-overwrite"/>
          <xe:group align="right" enabled="=cachelookup('feature', '@key', @feature)@color_type > 0">
            <xe:colorpicker label="${colour}" label-style="label-default" source="@color"/>
            <xe:deletebutton source="@color"/>
          </xe:group>
          <xe:include key="domains-required"/>
          <xe:editfield source="@sorting" label="${sorting}" label-style="label-default" width="10em" data-type="INTEGER">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:strut height="20"/>
          <!-- related feature values -->
          <xe:foreach source="feature_value_rel_def" row-align="down" weight-x="1" weight-y="1" new-button="false">
            <xe:separator/>
            <xe:label enabled="=@'is-child-rel' == 'true'" style="label-sub-title" value="=$$.feature@name + ': ' + @child_rel_name"/>
            <xe:label enabled="=@'is-child-rel' == 'false'" style="label-sub-title" value="=$$.feature@name + ': ' + @parent_rel_name"/>
            <xe:xe-table source="feature.feature_value" prefwidth="100" prefheight="50" weight-x="1" weight-y="1" keyboard-delete-action="delete-feature-value-rel" double-click-action="edit" ordercol="@name">
              <xe:columns>
                <xe:sorting>
                  <xe:sort-col key="name" ascending="true"/>
                </xe:sorting>
                <xe:column key="name" label="${name}" source="@name" width="20em" filterable="true"/>
                <xe:column key="value" label="${value}" source="@value_key" width="400" filterable="true"/>
                <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
                <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
              </xe:columns>
              <xe:dnd>
                <xe:drag mode="multi"/>
                <xe:drop mode="on_table" accept-element="feature_value" accept-multi="true" accept-same-table="false" action="add-child-feature-value">
                  <xe:filter source="@feature" match-source="$current.feature@key"/>
                </xe:drop>
              </xe:dnd>
            </xe:xe-table>
          </xe:foreach>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- FEATURE CATEGORY TABLE DIALOG -->
  <xe:part id="table-list-feature-categories" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="feature_categorys.feature_category" double-click-action="table-double-click"
        weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="feature" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="feature" label="${feature}" width="20em" filterable="true" formula="cachelookup('feature', '@key', @feature)@name"/>
          <xe:column key="category" label="${category}" source="@category" width="20em" filterable="true" formula="cachelookup('feature_value', '@value_key', @category, '@feature', 'censhare:category')@name"/>
          <xe:column key="group" label="${group}" width="20em" filterable="true" formula="cachelookup('feature_group', '@key', @feature_group)@name"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT FEATURE CATEGORY DIALOG -->
  <xe:part id="edit-record-feature-categories" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:popupmenu source="@feature" label="${feature}" label-style="label-default" width="30em" sort="ascending">
            <xe:options label-key="@name" value-key="@key">
              <xe:generator name="cachedtables" table-name="feature"/>
              <xe:filters combine="and">
                <xe:filter source="@key" match="censhare:keyword" operator="!="/>
                <xe:filter source="@key" match="censhare:category" operator="!="/>
              </xe:filters>
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:group>
            <xe:popupmenutree label="${category}" label-style="label-default" source="@category" hide-root-popup="false">
              <xe:treeoptions label-key="@name" value-key="@value_key">
                <xe:generator name="cachedtables" table-name="feature_value" source="@feature" match="censhare:category"/>
              </xe:treeoptions>
            </xe:popupmenutree>
            <xe:deletebutton source="@category"/>
          </xe:group>
          <xe:group>
            <xe:popupmenu source="@feature_group" label="${group}" label-style="label-default" width="30em" sort="ascending">
              <xe:options label-key="@name" value-key="@key">
                <xe:generator name="cachedtables" table-name="feature_group"/>
              </xe:options>
            </xe:popupmenu>
            <xe:deletebutton source="@feature_group"/>
          </xe:group>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- EVENT TABLE DIALOG -->
  <xe:part id="table-list-events" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="events.event" double-click-action="table-double-click"
        weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="id" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@name" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="30em" filterable="true"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT EVENT DIALOG -->
  <xe:part id="edit-record-events" transactional="true">
    <xe:inititems>
      <xe:inititem dest="@event_key" value="censhare.CustomAssetEvent"/>
      <xe:inititem dest="@eventsource" value="CustomAssetEvent"/>
      <xe:inititem dest="@param3" value="0"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@name">
            <xe:validate not-empty="true"/>
            <xe:change dest="@event_key" value="='censhare.CustomAssetEvent.'+$current@name"/>
          </xe:editfield>
          <xe:include key="localized-description"/>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- ABBREVIATION TABLE DIALOG -->
  <xe:part id="table-list-translation-abbreviation" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="translation_abbreviations.translation_abbreviation" double-click-action="table-double-click"
        weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="locale" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="locale" label="${locale}" width="10em" filterable="true" formula="cachelookup('java_locale', '@locale', @locale)@name"/>
          <xe:column key="text" label="${text}" source="@text" width="20em" filterable="true"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT ABBREVIATION DIALOG -->
  <xe:part id="edit-record-translation-abbreviation" transactional="true">
    <xe:inititems>
      <!--
          presets for the domain fields:
          you can only choose domains equal or lower than the users main-domains.
          the validation to suppress domains is done in a validation-listener.
      -->
      <!-- Slots are defined in the interface Slots -->
      <xe:inititem dest="@domain"  value="=$system.party@main_domain"  overwrite="false"/>
      <xe:inititem dest="@domain2" value="=$system.party@main_domain2" overwrite="false"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:popupmenu source="@locale" label="${language}" label-style="label-default" width="30em" sort="ascending">
            <!-- changed from @description to @name (description is empty)-->
            <xe:options label-key="@name" value-key="@tm_locale" null-entry="false">
              <xe:generator name="cachedtables" table-name="language_def"/>
            </xe:options>
          </xe:popupmenu>
          <xe:editfield label="${text}" label-style="label-default" width="30em" source="@text" />
          <xe:include key="domains-required"/>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- IMAGE RESOLUTION TABLE DIALOG -->
  <xe:part id="table-list-image-resolution" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
        <xe:xe-table id="table" filter-widget="table-filter" source="image_resolutions.image_resolution" double-click-action="table-double-click" weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="mimetype" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="mimetype" label="${mimetype}" width="25em" filterable="true" formula="cachelookup('mimetype', '@mimetype', @mimetype)@name"/>
          <xe:column key="colour-space" label="${colour-space}" width="10em" filterable="true" formula="case(@colorspace, 'bw', '${black-white}', 'gs', '${grayscale}', 'idx', '${indexed}', 'rgb', '${rgb}', 'lab', '${lab}', 'cmyk', '${cmyk}')"/>
          <xe:column key="dpi" label="${dpi}" source="@min_dpi" width="10em" filterable="true"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT IMAGE RESOLUTION DIALOG -->
  <xe:part id="edit-record-image-resolution" transactional="true">
    <xe:inititems>
      <!--
          presets for the domain fields:
          you can only choose domains equal or lower than the users main-domains.
          the validation to suppress domains is done in a validation-listener.
      -->
      <!-- Slots are defined in the interface Slots -->
      <xe:inititem dest="@domain"  value="=$system.party@main_domain"  overwrite="false"/>
      <xe:inititem dest="@domain2" value="=$system.party@main_domain2" overwrite="false"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:popupmenu source="@mimetype" label="${mimetype}" label-style="label-default" width="30em" sort="ascending">
            <!-- changed from @description to @name (popup was empty) -->
            <xe:options label-key="@name" value-key="@mimetype">
              <xe:generator name="cachedtables" table-name="mimetype"/>
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:popupmenu source="@colorspace" label="${colour-space}" label-style="label-default" width="30em">
            <xe:options>
              <xe:option label="${black-white}" value="bw"/>
              <xe:option label="${grayscale}" value="gs"/>
              <xe:option label="${indexed}" value="idx"/>
              <xe:option label="${rgb}" value="rgb"/>
              <xe:option label="${lab}" value="lab"/>
              <xe:option label="${cmyk}" value="cmyk"/>
            </xe:options>
            <xe:validate not-empty="true"/>
          </xe:popupmenu>
          <xe:group>
            <xe:editfield label="${minimal-dpi}" label-style="label-default" width="10em" source="@min_dpi" data-type="INTEGER">
              <xe:validate not-empty="true" min-value="0"/>
            </xe:editfield>
            <xe:label value="${dpi}"/>
          </xe:group>
          <xe:include key="domains-required"/>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- UNITS TABLE DIALOG -->
  <xe:part id="table-list-units" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="units.unit" double-click-action="table-double-click"
                   weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="property" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@key" width="20em" filterable="true"/>
          <xe:column key="name" label="${name}" source="=:if ('' = '_de') then '@name_de' else '@name'" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="symbol" label="${symbol}" source="@symbol" width="15em" filterable="true"/>
          <xe:column key="symbol-alt" label="${alternate-symbol}" source="@symbol_alt" width="15em" filterable="true"/>
          <xe:column key="property" label="${property}" source="@property" width="20em" filterable="true"/>
          <xe:column key="unit-class" label="${category}" source="@unit_class" width="10em" filterable="true"/>
          <xe:column key="ece-key" label="${un-ece-key}" source="@ece_key" width="5em" filterable="true"/>
          <xe:column key="base-unit" label="${base-unit}" formula=":cs:cachelookup('unit', '@key', cs:cachelookup('unit_rel', '@unit', */@key)/@base_unit)/@symbol" width="8em" filterable="true"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT UNIT DIALOG -->
  <xe:part id="edit-record-units" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@key">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
          <xe:editfield label="${symbol}" label-style="label-default" width="30em" source="@symbol">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:editfield label="${alternate-symbol}" label-style="label-default" width="30em" source="@symbol_alt">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:editfield label="${property}" label-style="label-default" width="30em" source="@property">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:editfield label="${category}" label-style="label-default" width="30em" source="@unit_class">
            <xe:validate not-empty="true"/>
          </xe:editfield>
          <xe:editfield label="${un-ece-key}" label-style="label-default" width="30em" source="@ece_key"/>
        </xe:group>
      </xe:group>
      <!-- Unit rel -->
      <xe:label style="label-title" value="${base-unit}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:foreach source="unit_rel" align="down" row-align="right" not-empty="true" max-occurs="1">
          <xe:group align="down">
            <xe:popupmenu label="${unit}" label-style="label-default" weight-x="1" width="30em" source="@base_unit" sort="ascending">
              <xe:options label-key="@name" value-key="@key">
                <xe:generator name="cachedtables" table-name="unit"/>
              </xe:options>
              <xe:validate not-empty="true"/>
            </xe:popupmenu>
            <xe:editfield label="${factor}" label-style="label-default" width="30em" source="@value" data-type="NUMBER">
              <xe:validate not-empty="true"/>
            </xe:editfield>
          </xe:group>
          <xe:deletebutton align-y="top"/>
        </xe:foreach>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- UNIT SETS TABLE DIALOG -->
  <xe:part id="table-list-unit-sets" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="unit_sets.unit_set" double-click-action="table-double-click"
                   weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="key" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@key" width="30em" filterable="true"/>
          <xe:column key="name" label="${name}" source="=:if ('' = '_de') then '@name_de' else '@name'" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="property" label="${property}" source="@property" width="15em" filterable="true"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT UNIT SET DIALOG -->
  <xe:part id="edit-record-unit-sets" transactional="true">
    <xe:inititems>
      <!--
          presets for the domain fields:
          you can only choose domains equal or lower than the users main-domains.
          the validation to suppress domains is done in a validation-listener.
      -->
      <!-- Slots are defined in the interface Slots -->
      <xe:inititem dest="@domain"  value="=$system.party@main_domain"  overwrite="false"/>
      <xe:inititem dest="@domain2" value="=$system.party@main_domain2" overwrite="false"/>
    </xe:inititems>
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@key">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-\.0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="domains-required"/>
          <xe:editfield label="${property}" label-style="label-default" width="30em" source="@property">
            <xe:validate not-empty="true"/>
          </xe:editfield>
        </xe:group>
      </xe:group>
      <!-- Unit set rels -->
      <xe:label style="label-title" value="${units}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:group align="right">
          <xe:label label="${units}" label-style="label-default" align-y="top"/>
          <xe:foreach source="unit_set_rel" align="down" row-align="right" not-empty="true">
            <xe:popupmenu width="30em" source="@unit" sort="ascending">
              <xe:options label-key="@key" value-key="@key">
                <xe:generator name="cachedtables" table-name="unit"/>
                <!--xe:generator name="cachedtables" table-name="unit" source="@property" match-source="^.@property"/-->
              </xe:options>
              <xe:validate not-empty="true"/>
            </xe:popupmenu>
            <xe:editfield source="@sorting" label="${sorting}" width="5em" data-type="INTEGER">
              <xe:validate not-empty="true"/>
            </xe:editfield>
            <xe:deletebutton/>
            <xe:checkbox caption="${enabled}" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
              <xe:validate not-null="true"/>
            </xe:checkbox>
          </xe:foreach>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- EXTERNAL APPS TABLE DIALOG -->
  <xe:part id="table-list-ext-apps" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="ext_apps.ext_app" double-click-action="table-double-click"
                   weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="key" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@key" width="30em" filterable="true"/>
          <xe:column key="name" label="${name}" source="=:if ('' = '_de') then '@name_de' else '@name'" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="icon-id" label="${icon-id}" source="@icon_key" width="20em" filterable="true"/>
          <xe:column key="apple-bundle-id" label="${apple-bundle-id}" source="@apple_bundle_id" width="20em" filterable="true"/>
          <!--xe:column key="windows-prog-id" label="${windows-prog-id}" source="@windows_prog_id" width="20em" filterable="true"/-->
          <xe:column key="shortcut_mac" label="${shortcut-macintosh}" source="@shortcut_mac" width="20em" filterable="true"/>
          <!--xe:column key="shortcut_win" label="${shortcut-windows}" source="@shortcut_win" width="20em" filterable="true"/-->
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT EXTERNAL APP DIALOG -->
  <xe:part id="edit-record-ext-apps" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@key">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-\.0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
          <xe:editfield label="${icon-id}" label-style="label-default" width="30em" source="@icon_key">
          </xe:editfield>
          <xe:editfield label="${apple-bundle-id}" label-style="label-default" width="30em" source="@apple_bundle_id">
          </xe:editfield>
          <!--xe:editfield label="${windows-prog-id}" label-style="label-default" width="30em" source="@windows_prog_id">
          </xe:editfield-->
          <xe:editfield label="${shortcut-macintosh}" label-style="label-default" width="30em" source="@shortcut_mac">
          </xe:editfield>
          <!--xe:editfield label="${shortcut-windows}" label-style="label-default" width="30em" source="@shortcut_win">
          </xe:editfield-->
        </xe:group>
      </xe:group>
      <!-- External app mimetypes -->
      <xe:label style="label-title" value="${mimetypes}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
        <xe:group align="right">
          <xe:label label="${mimetypes}" label-style="label-default" align-y="top"/>
          <xe:foreach source="ext_app_mimetype" align="down" row-align="right" not-empty="true">
            <xe:popupmenu width="30em" source="@mimetype" sort="ascending">
              <xe:options label-key="@name" value-key="@mimetype">
                <xe:generator name="cachedtables" table-name="mimetype"/>
              </xe:options>
              <xe:validate not-empty="true"/>
            </xe:popupmenu>
            <xe:deletebutton/>
            <xe:checkbox caption="${enabled}" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
              <xe:validate not-null="true"/>
            </xe:checkbox>
          </xe:foreach>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- IMAGE CROP TABLE DIALOG -->
  <xe:part id="table-list-image-crops" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="image_crops.image_crop" double-click-action="table-double-click"
                   weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="key" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="id" label="${id}" source="@key" width="30em" filterable="true"/>
          <xe:column key="name" label="${name}" source="=:if ('' = '_de') then '@name_de' else '@name'" width="20em" filterable="true"/>
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="aspect-ratio" label="${fixed-aspect-ratio}" formula="@aspect_ratio_width + ':' + @aspect_ratio_height" width="20em" filterable="true"/>
          <xe:column key="is-fixed-size" label="${fixed-size}" source="@is_fixed_size" width="6em" type="bool"/>
          <xe:column key="fixed-size-width" label="${target-width}" source="@fixed_size_width" width="20em" filterable="true"/>
          <xe:column key="fixed-size-height" label="${target-height}" source="@fixed_size_height" width="20em" filterable="true"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT IMAGE CROP DIALOG -->
  <xe:part id="edit-record-image-crops" transactional="true">
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:editfield label="${id}" label-style="label-default" width="30em" source="@key">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-\.0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
          <xe:include key="localized-description"/>
          <xe:include key="domains-required"/>
          <xe:group>
            <xe:editfield label="${fixed-aspect-ratio}" label-style="label-default" width="10em" source="@aspect_ratio_width" data-type="NUMBER"/>
            <xe:editfield label="x" width="10em" source="@aspect_ratio_height" data-type="NUMBER"/>
          </xe:group>
          <xe:checkbox label="${fixed-size}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@is_fixed_size">
          </xe:checkbox>
          <xe:group align="down" visible="=@is_fixed_size='1'">
            <xe:listen-to source="@is_fixed_size"/>
            <xe:group>
              <xe:editfield label="${fixed-width}" label-style="label-default" width="10em" source="@fixed_size_width" data-type="INTEGER">
              </xe:editfield>
              <xe:label value="${pixels}"/>
            </xe:group>
            <xe:group>
              <xe:editfield label="${fixed-height}" label-style="label-default" width="10em" source="@fixed_size_height" data-type="INTEGER">
              </xe:editfield>
              <xe:label value="${pixels}"/>
            </xe:group>
          </xe:group>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- DATA IMPORT WINDOW -->
  <xe:part id="data-import-window" transactional="false">
    <xe:group align="down">
      <xe:separator/>
      <xe:xe-table id="table" source="element">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="files" ascending="true"/>
          </xe:sorting>
        <xe:column label="${files}" source="@file" width="30em" key="files"/>
      </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- REGION -->
  <xe:part id="table-list-regions" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="regions.region" double-click-action="table-double-click" weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="pathid" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="pathid" label="${id}" source="@pathid" width="30em" filterable="true" />
          <xe:column key="name" label="${name}" source="@name" width="25em" filterable="true" />
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="sorting" label="${sorting}" source="@sorting" width="7em" align="right" filterable="false"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT REGION DIALOG -->
  <xe:part id="edit-record-regions" transactional="true">
    <!--  xe:inititems>
      <xe:inititem dest="@pathid" value="earth."/>
    </xe:inititems-->
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:popupmenutree label="${parent-region}" label-style="label-default" source="@parent" hide-root-popup="false">
            <xe:treeoptions label-key="@name" value-key="@pathid">
              <xe:generator name="cachedtables" table-name="region"/>
              <xe:sort key="@sorting" data-type="integer"/>
            </xe:treeoptions>
          </xe:popupmenutree>
          <xe:editfield label="${value}" label-style="label-default" width="30em" source="@shortname">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
           <xe:include key="localized-description"/>
          <xe:editfield label="${sorting}" label-style="label-default" width="10em" source="@sorting" data-type="INTEGER">
            <xe:validate not-empty="true"/>
          </xe:editfield>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

  <!-- PRINT-REGION -->
  <xe:part id="table-list-print-regions" transactional="true">
    <xe:group align="down">
      <xe:separator/>
      <xe:filterwidget id="table-filter" filter-directly="true"/>
      <xe:xe-table id="table" filter-widget="table-filter" source="print_regions.print_region" double-click-action="table-double-click" weight-x="1" weight-y="1" minwidth="50" minheight="50">
        <xe:columns>
          <xe:sorting>
            <xe:sort-col key="pathid" ascending="true"/>
          </xe:sorting>
          <xe:column key="enabled" label="${enabled}" source="@enabled" width="5em" type="bool"/>
          <xe:column key="locked" label="${locked}" formula=":if (*/@source) then '1' else '0'" width="5em" type="bool"/>
          <xe:column key="pathid" label="${id}" source="@pathid" width="30em" filterable="true" />
          <xe:column key="name" label="${name}" source="@name" width="25em" filterable="true" />
          <xe:column key="description" label="${description}" source="@description" width="20em" filterable="true"/>
          <xe:column key="sorting" label="${sorting}" source="@sorting" width="7em" align="right" filterable="false"/>
          <xe:column key="domain" label="${domain}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain, '\.')))) return cs:cachelookup('domain', '@pathid', concat(string-join(subsequence(tokenize(*/@domain, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
          <xe:column key="domain2" label="${domain2}" width="20em" filterable="true" formula=":string-join(for $x in (1 to xs:long(count(tokenize(*/@domain2, '\.')))) return cs:cachelookup('domain2', '@pathid', concat(string-join(subsequence(tokenize(*/@domain2, '\.'), 1, $x), '.'), '.'))/@name, '/')"/>
        </xe:columns>
      </xe:xe-table>
    </xe:group>
  </xe:part>

  <!-- EDIT PRINT-REGION DIALOG -->
  <xe:part id="edit-record-print-regions" transactional="true">
    <!--  xe:inititems>
      <xe:inititem dest="@pathid" value="earth."/>
    </xe:inititems-->
    <xe:group align="down">
      <xe:include key="locked-description"/>
      <xe:label style="label-title" value="${general}" weight-x="1"/>
      <xe:group style="group-indent-left-right" align="down">
        <xe:checkbox label="${enabled}" label-style="label-default" checked-value="1" unchecked-value="0" defaultvalue="1" source="@enabled">
          <xe:validate not-null="true"/>
        </xe:checkbox>
        <xe:group align="down" readonly="=:exists(*/@source) and system-property('censhare:is-admin-mode')='false'">
          <xe:popupmenutree label="${parent-region}" label-style="label-default" source="@parent" hide-root-popup="false">
            <xe:treeoptions label-key="@name" value-key="@pathid">
              <xe:generator name="cachedtables" table-name="print_region"/>
              <xe:sort key="@sorting" data-type="integer"/>
            </xe:treeoptions>
          </xe:popupmenutree>
          <xe:editfield label="${value}" label-style="label-default" width="30em" source="@shortname">
            <xe:validate not-empty="true" regex="[a-zA-Z_:\-0-9]*"/>
          </xe:editfield>
          <xe:include key="localized-name-required"/>
           <xe:include key="localized-description"/>
          <xe:editfield label="${sorting}" label-style="label-default" width="10em" source="@sorting" data-type="INTEGER">
            <xe:validate not-empty="true"/>
          </xe:editfield>
        </xe:group>
      </xe:group>
    </xe:group>
  </xe:part>

</cmd>
